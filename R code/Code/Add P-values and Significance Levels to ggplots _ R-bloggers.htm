<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" prefix="og: http://ogp.me/ns#"
	itemscope 
	itemtype="http://schema.org/WebSite" >

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Add P-values and Significance Levels to ggplots | R-bloggers</title>

<script src="/cdn-cgi/apps/head/pAx-dKbLyle7umPnDyx7D0pQbKA.js"></script><script type="text/javascript">
//<![CDATA[
window.__cfRocketOptions = {byc:0,p:0,petok:"009a7d73a5b3c55218ef0b0be94c1186a553181c-1510312274-1800"};
//]]>
</script>
<script type="text/javascript" src="https://ajax.cloudflare.com/cdn-cgi/scripts/84a23a00/cloudflare-static/rocket.min.js"></script>
<link rel="stylesheet" href="https://www.r-bloggers.com/wp-content/themes/magazine-basic-child/style.css" type="text/css" media="screen" />

<style type="text/css">

body { width: 1024px; }

#mainwrapper { width: 1004px; }

#sidebar { width: 180px; }

#sidebar .side-widget { width: 160px; }


#secondsidebar { width: 300px; }

#secondsidebar .side-widget { width: 300px; }


#leftcontent, #twocol, #threecol, #threecol2, .commentlist { width: 456px; }

#leftcontent img, .wp-caption { max-width: 456px; }

#leftcontent .wp-caption img, #leftcontent .gallery-thumb img { max-width: 444px; }

<!-- fix for IE & Safari -->

.threepost embed { width: 132.24px !important; }

.twopost embed { width: 209.76px !important; }

<!-- end fix for Safari -->

</style>

	<link rel="pingback" href="https://www.r-bloggers.com/xmlrpc.php" />
<!--[if IE]>
<link rel="stylesheet" type="text/css" href="https://www.r-bloggers.com/wp-content/themes/magazine-basic/iestyles.css" />
<![endif]-->

<!-- Open Graph Meta Tags generated by MashShare 3.4.2 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Add P-values and Significance Levels to ggplots" />
<meta property="og:description" content="&lt;!-- START HTML --&gt;    &lt;!--====================== start from here when you copy to sthda================--&gt;     &lt;div&gt;  &lt;p&gt;&lt;br&gt;&lt;/p&gt; &lt;p&gt;In this article, we’ll describe how to easily i) &lt;strong&gt;compare means&lt;/strong&gt; of two or multiple groups; ii) and to automatically add &lt;strong&gt;p-values&lt;/strong&gt; and &lt;strong&gt;significance levels&lt;/strong&gt; to a ggplot (such as box plots, dot plots, bar plots and line plots …).&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Contents&lt;/strong&gt;:&lt;/p&gt;  &lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#prerequisites&quot;&gt;Prerequisites&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#methods-for-comparing-means&quot;&gt;Methods for comparing means&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#r-functions-to-add-p-values&quot;&gt;R functions to add p-values&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-two-independent-groups&quot;&gt;Compare two independent groups&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-two-paired-samples&quot;&gt;Compare two paired samples&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-more-than-two-groups&quot;&gt;Compare more than two groups&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#multiple-grouping-variables&quot;&gt;Multiple grouping variables&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#other-plot-types&quot;&gt;Other plot types&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#infos&quot;&gt;Infos&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;   &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Prerequisites&lt;/h2&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;Install and load required R packages&lt;/h3&gt; &lt;p&gt;Required R package: &lt;a href=&quot;http://www.sthda.com/english/rpkgs/ggpubr&quot;&gt;ggpubr (version &amp;gt;= 0.1.3)&lt;/a&gt;, for ggplot2-based publication ready plots.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Install from &lt;a href=&quot;https://cran.r-project.org/package=ggpubr&quot;&gt;CRAN&lt;/a&gt; as follow:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;install.packages(&quot;ggpubr&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;ul&gt; &lt;li&gt;Or, install the latest developmental version from &lt;a href=&quot;https://github.com/kassambara/ggpubr&quot;&gt;GitHub&lt;/a&gt; as follow:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;if(!require(devtools)) install.packages(&quot;devtools&quot;) devtools::install_github(&quot;kassambara/ggpubr&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;ul&gt; &lt;li&gt;Load ggpubr:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;library(ggpubr)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;success&quot;&gt; &lt;p&gt; Official documentation of ggpubr is available at: &lt;a href=&quot;http://www.sthda.com/english/rpkgs/ggpubr&quot; class=&quot;uri&quot;&gt;http://www.sthda.com/english/rpkgs/ggpubr&lt;/a&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;Demo data sets&lt;/h3&gt; &lt;p&gt;Data: &lt;a href=&quot;http://www.sthda.com/english/wiki/r-built-in-data-sets#toothgrowth&quot;&gt;ToothGrowth&lt;/a&gt; data sets.&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;data(&quot;ToothGrowth&quot;) head(ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;   len supp dose 1  4.2   VC  0.5 2 11.5   VC  0.5 3  7.3   VC  0.5 4  5.8   VC  0.5 5  6.4   VC  0.5 6 10.0   VC  0.5&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Methods for comparing means&lt;/h2&gt; &lt;p&gt;The standard methods to compare the means of two or more groups in R, have been largely described at: &lt;a href=&quot;http://www.sthda.com/english/wiki/comparing-means-in-r&quot;&gt;comparing means in R&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;The most common methods for comparing means include:&lt;/p&gt; &lt;table&gt; &lt;thead&gt;&lt;tr class=&quot;header&quot;&gt; &lt;th&gt;Methods&lt;/th&gt; &lt;th&gt;R function&lt;/th&gt; &lt;th&gt;Description&lt;/th&gt; &lt;/tr&gt;&lt;/thead&gt; &lt;tbody&gt; &lt;tr class=&quot;odd&quot;&gt; &lt;td&gt;T-test&lt;/td&gt; &lt;td&gt;t.test()&lt;/td&gt; &lt;td&gt;Compare two groups (parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;even&quot;&gt; &lt;td&gt;Wilcoxon test&lt;/td&gt; &lt;td&gt;wilcox.test()&lt;/td&gt; &lt;td&gt;Compare two groups (non-parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;odd&quot;&gt; &lt;td&gt;ANOVA&lt;/td&gt; &lt;td&gt;aov() or anova()&lt;/td&gt; &lt;td&gt;Compare multiple groups (parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;even&quot;&gt; &lt;td&gt;Kruskal-Wallis&lt;/td&gt; &lt;td&gt;kruskal.test()&lt;/td&gt; &lt;td&gt;Compare multiple groups (non-parametric)&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;p&gt;A practical guide to compute and interpret the results of each of these methods are provided at the following links:&lt;/p&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; Comparing one-sample mean to a standard known mean: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-sample-t-test-in-r&quot;&gt;One-Sample T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-sample-wilcoxon-signed-rank-test-in-r&quot;&gt;One-Sample Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of two independent groups: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r&quot;&gt;Unpaired Two Samples T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/unpaired-two-samples-wilcoxon-test-in-r&quot;&gt;Unpaired Two-Samples Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of paired samples: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/paired-samples-t-test-in-r&quot;&gt;Paired Samples T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/paired-samples-wilcoxon-test-in-r&quot;&gt;Paired Samples Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of more than two groups &lt;ul&gt; &lt;li&gt; Analysis of variance (ANOVA, parametric): &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-way-anova-test-in-r&quot;&gt;One-Way ANOVA Test in R&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/two-way-anova-test-in-r&quot;&gt;Two-Way ANOVA Test in R&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/kruskal-wallis-test-in-r&quot;&gt;Kruskal-Wallis Test in R (non parametric alternative to one-way ANOVA)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;R functions to add p-values&lt;/h2&gt; &lt;p&gt;Here we present two new R functions in the &lt;strong&gt;ggpubr&lt;/strong&gt; package:&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;compare_means&lt;/strong&gt;(): easy to use solution to performs one and multiple mean comparisons.&lt;/li&gt; &lt;li&gt; &lt;strong&gt;stat_compare_means&lt;/strong&gt;(): easy to use solution to automatically add p-values and significance levels to a ggplot.&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;compare_means()&lt;/h3&gt; &lt;p&gt;As we’ll show in the next sections, it has multiple useful options compared to the standard R functions.&lt;/p&gt; &lt;p&gt;The simplified format is as follow:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(formula, data, method = &quot;wilcox.test&quot;, paired = FALSE,   group.by = NULL, ref.group = NULL, ...)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;formula&lt;/strong&gt;: a formula of the form &lt;em&gt;x ~ group&lt;/em&gt;, where x is a numeric variable and group is a factor with one or multiple levels. For example, &lt;em&gt;formula = TP53 ~ cancer_group&lt;/em&gt;. It’s also possible to perform the test for multiple response variables at the same time. For example, &lt;em&gt;formula = c(TP53, PTEN) ~ cancer_group&lt;/em&gt;. &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;data&lt;/strong&gt;: a data.frame containing the variables in the formula. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;strong&gt;method&lt;/strong&gt;: the type of test. Default is &lt;em&gt;“wilcox.test”&lt;/em&gt;. Allowed values include: &lt;ul&gt; &lt;li&gt; &lt;em&gt;“t.test”&lt;/em&gt; (parametric) and &lt;em&gt;“wilcox.test”&lt;/em&gt;&quot; (non-parametric). Perform comparison between two groups of samples. If the grouping variable contains more than two levels, then a pairwise comparison is performed. &lt;/li&gt; &lt;li&gt; &lt;em&gt;“anova”&lt;/em&gt; (parametric) and &lt;em&gt;“kruskal.test”&lt;/em&gt; (non-parametric). Perform one-way ANOVA test comparing multiple groups. &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;paired&lt;/strong&gt;: a logical indicating whether you want a paired test. Used only in &lt;em&gt;t.test&lt;/em&gt; and in &lt;em&gt;wilcox.test&lt;/em&gt;. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;group.by&lt;/strong&gt;: variables used to group the data set before applying the test. When specified the mean comparisons will be performed in each subset of the data formed by the different levels of the group.by variables. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;ref.group&lt;/strong&gt;: a character string specifying the reference group. If specified, for a given grouping variable, each of the group levels will be compared to the reference group (i.e. control group). ref.group can be also &lt;em&gt;“.all.”&lt;/em&gt;. In this case, each of the grouping variable levels is compared to all (i.e. base-mean). &lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;stat_compare_means()&lt;/h3&gt; &lt;p&gt;This function extends ggplot2 for adding mean comparison p-values to a ggplot, such as box blots, dot plots, bar plots and line plots.&lt;/p&gt; &lt;p&gt;The simplified format is as follow:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;stat_compare_means(mapping = NULL, comparisons = NULL hide.ns = FALSE,                    label = NULL,  label.x = NULL, label.y = NULL,  ...)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;mapping&lt;/strong&gt;: Set of aesthetic mappings created by aes(). &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;comparisons&lt;/strong&gt;: A list of length-2 vectors. The entries in the vector are either the names of 2 values on the x-axis or the 2 integers that correspond to the index of the groups of interest, to be compared. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;hide.ns&lt;/strong&gt;: logical value. If TRUE, hide ns symbol when displaying significance levels. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;label&lt;/strong&gt;: character string specifying label type. Allowed values include “p.signif” (shows the significance levels), “p.format” (shows the formatted p value). &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;label.x,label.y&lt;/strong&gt;: numeric values. coordinates (in data units) to be used for absolute positioning of the label. If too short they will be recycled. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;…&lt;/strong&gt;: other arguments passed to the function &lt;strong&gt;compare_means&lt;/strong&gt;() such as &lt;em&gt;method&lt;/em&gt;, &lt;em&gt;paired&lt;/em&gt;, &lt;em&gt;ref.group&lt;/em&gt;. &lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare two independent groups&lt;/h2&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 8     .y. group1 group2          p      p.adj p.format p.signif   method    1   len     OJ     VC 0.06449067 0.06449067    0.064       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; By default &lt;strong&gt;method = “wilcox.test”&lt;/strong&gt; (non-parametric test). You can also specify &lt;strong&gt;method = “t.test”&lt;/strong&gt; for a parametric t-test. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Returned value is a data frame with the following columns:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;.y.: the y variable used in the test.&lt;/li&gt; &lt;li&gt;p: the p-value&lt;/li&gt; &lt;li&gt;p.adj: the adjusted p-value. Default value for p.adjust.method = “holm”&lt;/li&gt; &lt;li&gt;p.format: the formatted p-value&lt;/li&gt; &lt;li&gt;p.signif: the significance level.&lt;/li&gt; &lt;li&gt;method: the statistical test used to compare groups.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Create a box plot with p-values:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Note that, the p-value label position can be adjusted using the arguments: &lt;em&gt;label.x, label.y, hjust and vjust&lt;/em&gt;.&lt;/p&gt; &lt;p&gt;The default p-value label displayed is obtained by concatenating the &lt;strong&gt;method&lt;/strong&gt; and the &lt;strong&gt;p&lt;/strong&gt; columns of the returned data frame by the function &lt;strong&gt;compare_means&lt;/strong&gt;(). You can specify other combinations using the &lt;strong&gt;aes&lt;/strong&gt;() function.&lt;/p&gt; &lt;p&gt;For example,&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;aes(label = ..p.format..)&lt;/strong&gt; or &lt;strong&gt;aes(label = paste0(“p =”, ..p.format..))&lt;/strong&gt;: display only the formatted p-value (without the method name)&lt;/li&gt; &lt;li&gt; &lt;strong&gt;aes(label = ..p.signif..)&lt;/strong&gt;: display only the significance level.&lt;/li&gt; &lt;li&gt; &lt;strong&gt;aes(label = paste0(..method.., “\n”, “p =”, ..p.format..))&lt;/strong&gt;: Use line break (“\n”) between the method name and the p-value.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;As an illustration, type this:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p + stat_compare_means( aes(label = ..p.signif..),                          label.x = 1.5, label.y = 40)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;If you prefer, it’s also possible to specify the argument &lt;em&gt;label&lt;/em&gt; as a character vector:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p + stat_compare_means( label = &quot;p.signif&quot;, label.x = 1.5, label.y = 40)&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare two paired samples&lt;/h2&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth, paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 8     .y. group1 group2           p       p.adj p.format p.signif   method    1   len     OJ     VC 0.004312554 0.004312554   0.0043       ** Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Visualize paired data using the &lt;strong&gt;ggpaired&lt;/strong&gt;() function:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggpaired(ToothGrowth, x = &quot;supp&quot;, y = &quot;len&quot;,          color = &quot;supp&quot;, line.color = &quot;gray&quot;, line.size = 0.4,          palette = &quot;jco&quot;)+   stat_compare_means(paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-paired-tests-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare more than two groups&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;Global test:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Global test compare_means(len ~ dose,  data = ToothGrowth, method = &quot;anova&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 6     .y.            p        p.adj p.format p.signif method    1   len 9.532727e-16 9.532727e-16  9.5e-16     ****  Anova&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Plot with global p-value:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Default method = &quot;kruskal.test&quot; for multiple groups ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means()  # Change method to anova ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Pairwise comparisons&lt;/strong&gt;. If the grouping variable contains more than two levels, then pairwise tests will be performed automatically. The default method is “wilcox.test”. You can change this to “t.test”.&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Perorm pairwise comparisons compare_means(len ~ dose,  data = ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 8     .y. group1 group2            p        p.adj p.format p.signif   method    1   len    0.5      1 7.020855e-06 1.404171e-05  7.0e-06     **** Wilcoxon 2   len    0.5      2 8.406447e-08 2.521934e-07  8.4e-08     **** Wilcoxon 3   len      1      2 1.772382e-04 1.772382e-04  0.00018      *** Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize: Specify the comparisons you want my_comparisons &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;If you want to specify the precise y location of bars, use the argument &lt;strong&gt;label.y&lt;/strong&gt;:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+    stat_compare_means(comparisons = my_comparisons, label.y = c(29, 35, 40))+   stat_compare_means(label.y = 45)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;(Adding bars, connecting compared groups, has been facilitated by the &lt;a href=&quot;https://github.com/Artjom-Metro/ggsignif&quot;&gt;ggsignif&lt;/a&gt; R package )&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Multiple pairwise tests against a reference group&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Pairwise comparison against reference compare_means(len ~ dose,  data = ToothGrowth, ref.group = &quot;0.5&quot;,               method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 2 x 8     .y. group1 group2            p        p.adj p.format p.signif method    1   len    0.5      1 6.697250e-09 6.697250e-09  6.7e-09     **** T-test 2   len    0.5      2 1.469534e-16 2.939068e-16  &lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;, label.y = 40)+      # Add global p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;0.5&quot;)                    # Pairwise comparison against reference&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-reference-group-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Multiple pairwise tests against all (base-mean)&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Comparison of each group against base-mean compare_means(len ~ dose,  data = ToothGrowth, ref.group = &quot;.all.&quot;,               method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 8     .y. group1 group2            p        p.adj p.format p.signif method    1   len  .all.    0.5 1.244626e-06 3.733877e-06  1.2e-06     **** T-test 2   len  .all.      1 5.667266e-01 5.667266e-01     0.57       ns T-test 3   len  .all.      2 1.371704e-05 2.743408e-05  1.4e-05     **** T-test&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;, label.y = 40)+      # Add global p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;)                  # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;A typical situation, where pairwise comparisons against “all” can be useful, is illustrated here using the &lt;em&gt;myeloma&lt;/em&gt; data set from the &lt;a href=&quot;https://github.com/kassambara/survminer&quot;&gt;&lt;strong&gt;survminer&lt;/strong&gt;&lt;/a&gt; package.&lt;/p&gt; &lt;p&gt;We’ll plot the expression profile of the DEPDC1 gene according to the patients’ molecular groups. We want to know if there is any difference between groups. If yes, where the difference is?&lt;/p&gt; &lt;p&gt;To answer to this question, you can perform a pairwise comparison between all the 7 groups. This will lead to a lot of comparisons between all possible combinations. If you have many groups, as here, it might be difficult to interpret.&lt;/p&gt; &lt;p&gt;Another easy solution is to compare each of the seven groups against “all” (i.e. base-mean). When the test is significant, then you can conclude that DEPDC1 is significantly overexpressed or downexpressed in a group xxx compared to all.&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Load myeloma data from survminer package if(!require(survminer)) install.packages(&quot;survminer&quot;) data(&quot;myeloma&quot;, package = &quot;survminer&quot;)  # Perform the test compare_means(DEPDC1 ~ molecular_group,  data = myeloma,               ref.group = &quot;.all.&quot;, method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 7 x 8      .y. group1           group2            p        p.adj p.format p.signif method     1 DEPDC1  .all.       Cyclin D-1 1.496896e-01 4.490687e-01  0.14969       ns T-test 2 DEPDC1  .all.       Cyclin D-2 5.231428e-01 1.000000e+00  0.52314       ns T-test 3 DEPDC1  .all.     Hyperdiploid 2.815333e-04 1.689200e-03  0.00028      *** T-test 4 DEPDC1  .all. Low bone disease 5.083985e-03 2.541992e-02  0.00508       ** T-test 5 DEPDC1  .all.              MAF 8.610664e-02 3.444265e-01  0.08611       ns T-test 6 DEPDC1  .all.            MMSET 5.762908e-01 1.000000e+00  0.57629       ns T-test 7 DEPDC1  .all.    Proliferation 1.241416e-09 8.689910e-09  1.2e-09     **** T-test&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize the expression profile ggboxplot(myeloma, x = &quot;molecular_group&quot;, y = &quot;DEPDC1&quot;, color = &quot;molecular_group&quot;,            add = &quot;jitter&quot;, legend = &quot;none&quot;) +   rotate_x_text(angle = 45)+   geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean   stat_compare_means(method = &quot;anova&quot;, label.y = 1600)+        # Add global annova p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;)                      # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean2-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;success&quot;&gt; &lt;p&gt; From the plot above, we can conclude that DEPDC1 is significantly overexpressed in proliferation group and, it’s significantly downexpressed in Hyperdiploid and Low bone disease compared to all. &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; Note that, if you want to hide the ns symbol, specify the argument &lt;em&gt;hide.ns = TRUE&lt;/em&gt;. &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize the expression profile ggboxplot(myeloma, x = &quot;molecular_group&quot;, y = &quot;DEPDC1&quot;, color = &quot;molecular_group&quot;,            add = &quot;jitter&quot;, legend = &quot;none&quot;) +   rotate_x_text(angle = 45)+   geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean   stat_compare_means(method = &quot;anova&quot;, label.y = 1600)+        # Add global annova p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;, hide.ns = TRUE)      # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Multiple grouping variables&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Two independent sample comparisons after grouping the data by another variable&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth,                group.by = &quot;dose&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 9    dose   .y. group1 group2           p      p.adj p.format p.signif   method    1   0.5   len     OJ     VC 0.023186427 0.04637285    0.023        * Wilcoxon 2   1.0   len     OJ     VC 0.004030367 0.01209110    0.004       ** Wilcoxon 3   2.0   len     OJ     VC 1.000000000 1.00000000    1.000       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;notice&quot;&gt; &lt;p&gt; In the example above, for each level of the variable “dose”, we compare the means of the variable “len” in the different groups formed by the grouping variable “supp”. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Visualize (1/2). Create a multi-panel box plots facetted by group (here, “dose”):&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Box plot facetted by &quot;dose&quot; p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Or use significance symbol as label p + stat_compare_means(label =  &quot;p.signif&quot;, label.x = 1.5)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; To hide the ‘ns’ symbol, use the argument &lt;strong&gt;hide.ns = TRUE&lt;/strong&gt;. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Visualize (2/2). Create one single panel with all box plots. Plot y = “len” by x = “dose” and color by “supp”:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Show only p-value p + stat_compare_means(aes(group = supp), label = &quot;p.format&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Use significance symbol as label p + stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-3.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Paired sample comparisons after grouping the data by another variable&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth,                group.by = &quot;dose&quot;, paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 9    dose   .y. group1 group2          p      p.adj p.format p.signif   method    1   0.5   len     OJ     VC 0.03296938 0.06593876    0.033        * Wilcoxon 2   1.0   len     OJ     VC 0.01905889 0.05717667    0.019        * Wilcoxon 3   2.0   len     OJ     VC 1.00000000 1.00000000    1.000       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Visualize. Create a multi-panel box plots facetted by group (here, “dose”):&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Box plot facetted by &quot;dose&quot; p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-paired-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Other plot types&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Bar and line plots&lt;/strong&gt; (one grouping variable):&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Bar plot of mean +/-se ggbarplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;)+   stat_compare_means() +                                         # Global p-value   stat_compare_means(ref.group = &quot;0.5&quot;, label = &quot;p.signif&quot;,                      label.y = c(22, 29))                   # compare to ref.group  # Line plot of mean +/-se ggline(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;)+   stat_compare_means() +                                         # Global p-value   stat_compare_means(ref.group = &quot;0.5&quot;, label = &quot;p.signif&quot;,                      label.y = c(22, 29))     &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Bar and line plots&lt;/strong&gt; (two grouping variables):&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggbarplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;,           color = &quot;supp&quot;, palette = &quot;jco&quot;,            position = position_dodge(0.8))+   stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;, label.y = 29)  ggline(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;,           color = &quot;supp&quot;, palette = &quot;jco&quot;)+   stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;,                       label.y = c(16, 25, 29))&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Infos&lt;/h2&gt; &lt;p&gt;This analysis has been performed using &lt;strong&gt;R software&lt;/strong&gt; (ver. 3.3.2) and &lt;strong&gt;ggpubr&lt;/strong&gt; (ver. 0.1.3).&lt;/p&gt; &lt;/div&gt;  &lt;/div&gt; &lt;!--end rdoc--&gt; &lt;!--====================== stop here when you copy to sthda================--&gt;   &lt;!-- END HTML --&gt;" />
<meta property="og:url" content="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" />
<meta property="og:site_name" content="R-bloggers" />
<meta property="article:publisher" content="https://www.facebook.com/rbloggers/" />
<meta property="article:published_time" content="2017-06-08T03:48:52+00:00" />
<meta property="article:modified_time" content="2017-06-08T03:48:52+00:00" />
<meta property="og:updated_time" content="2017-06-08T03:48:52+00:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.4.2 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.4.2 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Add P-values and Significance Levels to ggplots">
<meta name="twitter:description" content="&lt;!-- START HTML --&gt;    &lt;!--====================== start from here when you copy to sthda================--&gt;     &lt;div&gt;  &lt;p&gt;&lt;br&gt;&lt;/p&gt; &lt;p&gt;In this article, we’ll describe how to easily i) &lt;strong&gt;compare means&lt;/strong&gt; of two or multiple groups; ii) and to automatically add &lt;strong&gt;p-values&lt;/strong&gt; and &lt;strong&gt;significance levels&lt;/strong&gt; to a ggplot (such as box plots, dot plots, bar plots and line plots …).&lt;/p&gt; &lt;p&gt;&lt;strong&gt;Contents&lt;/strong&gt;:&lt;/p&gt;  &lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#prerequisites&quot;&gt;Prerequisites&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#methods-for-comparing-means&quot;&gt;Methods for comparing means&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#r-functions-to-add-p-values&quot;&gt;R functions to add p-values&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-two-independent-groups&quot;&gt;Compare two independent groups&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-two-paired-samples&quot;&gt;Compare two paired samples&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#compare-more-than-two-groups&quot;&gt;Compare more than two groups&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#multiple-grouping-variables&quot;&gt;Multiple grouping variables&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#other-plot-types&quot;&gt;Other plot types&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;http://www.sthda.com/#infos&quot;&gt;Infos&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;   &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Prerequisites&lt;/h2&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;Install and load required R packages&lt;/h3&gt; &lt;p&gt;Required R package: &lt;a href=&quot;http://www.sthda.com/english/rpkgs/ggpubr&quot;&gt;ggpubr (version &amp;gt;= 0.1.3)&lt;/a&gt;, for ggplot2-based publication ready plots.&lt;/p&gt; &lt;ul&gt; &lt;li&gt;Install from &lt;a href=&quot;https://cran.r-project.org/package=ggpubr&quot;&gt;CRAN&lt;/a&gt; as follow:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;install.packages(&quot;ggpubr&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;ul&gt; &lt;li&gt;Or, install the latest developmental version from &lt;a href=&quot;https://github.com/kassambara/ggpubr&quot;&gt;GitHub&lt;/a&gt; as follow:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;if(!require(devtools)) install.packages(&quot;devtools&quot;) devtools::install_github(&quot;kassambara/ggpubr&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;ul&gt; &lt;li&gt;Load ggpubr:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;library(ggpubr)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;success&quot;&gt; &lt;p&gt; Official documentation of ggpubr is available at: &lt;a href=&quot;http://www.sthda.com/english/rpkgs/ggpubr&quot; class=&quot;uri&quot;&gt;http://www.sthda.com/english/rpkgs/ggpubr&lt;/a&gt; &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;Demo data sets&lt;/h3&gt; &lt;p&gt;Data: &lt;a href=&quot;http://www.sthda.com/english/wiki/r-built-in-data-sets#toothgrowth&quot;&gt;ToothGrowth&lt;/a&gt; data sets.&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;data(&quot;ToothGrowth&quot;) head(ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;   len supp dose 1  4.2   VC  0.5 2 11.5   VC  0.5 3  7.3   VC  0.5 4  5.8   VC  0.5 5  6.4   VC  0.5 6 10.0   VC  0.5&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Methods for comparing means&lt;/h2&gt; &lt;p&gt;The standard methods to compare the means of two or more groups in R, have been largely described at: &lt;a href=&quot;http://www.sthda.com/english/wiki/comparing-means-in-r&quot;&gt;comparing means in R&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;The most common methods for comparing means include:&lt;/p&gt; &lt;table&gt; &lt;thead&gt;&lt;tr class=&quot;header&quot;&gt; &lt;th&gt;Methods&lt;/th&gt; &lt;th&gt;R function&lt;/th&gt; &lt;th&gt;Description&lt;/th&gt; &lt;/tr&gt;&lt;/thead&gt; &lt;tbody&gt; &lt;tr class=&quot;odd&quot;&gt; &lt;td&gt;T-test&lt;/td&gt; &lt;td&gt;t.test()&lt;/td&gt; &lt;td&gt;Compare two groups (parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;even&quot;&gt; &lt;td&gt;Wilcoxon test&lt;/td&gt; &lt;td&gt;wilcox.test()&lt;/td&gt; &lt;td&gt;Compare two groups (non-parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;odd&quot;&gt; &lt;td&gt;ANOVA&lt;/td&gt; &lt;td&gt;aov() or anova()&lt;/td&gt; &lt;td&gt;Compare multiple groups (parametric)&lt;/td&gt; &lt;/tr&gt; &lt;tr class=&quot;even&quot;&gt; &lt;td&gt;Kruskal-Wallis&lt;/td&gt; &lt;td&gt;kruskal.test()&lt;/td&gt; &lt;td&gt;Compare multiple groups (non-parametric)&lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;p&gt;A practical guide to compute and interpret the results of each of these methods are provided at the following links:&lt;/p&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; Comparing one-sample mean to a standard known mean: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-sample-t-test-in-r&quot;&gt;One-Sample T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-sample-wilcoxon-signed-rank-test-in-r&quot;&gt;One-Sample Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of two independent groups: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r&quot;&gt;Unpaired Two Samples T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/unpaired-two-samples-wilcoxon-test-in-r&quot;&gt;Unpaired Two-Samples Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of paired samples: &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/paired-samples-t-test-in-r&quot;&gt;Paired Samples T-test (parametric)&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/paired-samples-wilcoxon-test-in-r&quot;&gt;Paired Samples Wilcoxon Test (non-parametric)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; Comparing the means of more than two groups &lt;ul&gt; &lt;li&gt; Analysis of variance (ANOVA, parametric): &lt;ul&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/one-way-anova-test-in-r&quot;&gt;One-Way ANOVA Test in R&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/two-way-anova-test-in-r&quot;&gt;Two-Way ANOVA Test in R&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;a href=&quot;http://www.sthda.com/english/wiki/kruskal-wallis-test-in-r&quot;&gt;Kruskal-Wallis Test in R (non parametric alternative to one-way ANOVA)&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;R functions to add p-values&lt;/h2&gt; &lt;p&gt;Here we present two new R functions in the &lt;strong&gt;ggpubr&lt;/strong&gt; package:&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;compare_means&lt;/strong&gt;(): easy to use solution to performs one and multiple mean comparisons.&lt;/li&gt; &lt;li&gt; &lt;strong&gt;stat_compare_means&lt;/strong&gt;(): easy to use solution to automatically add p-values and significance levels to a ggplot.&lt;/li&gt; &lt;/ul&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;compare_means()&lt;/h3&gt; &lt;p&gt;As we’ll show in the next sections, it has multiple useful options compared to the standard R functions.&lt;/p&gt; &lt;p&gt;The simplified format is as follow:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(formula, data, method = &quot;wilcox.test&quot;, paired = FALSE,   group.by = NULL, ref.group = NULL, ...)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;formula&lt;/strong&gt;: a formula of the form &lt;em&gt;x ~ group&lt;/em&gt;, where x is a numeric variable and group is a factor with one or multiple levels. For example, &lt;em&gt;formula = TP53 ~ cancer_group&lt;/em&gt;. It’s also possible to perform the test for multiple response variables at the same time. For example, &lt;em&gt;formula = c(TP53, PTEN) ~ cancer_group&lt;/em&gt;. &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;data&lt;/strong&gt;: a data.frame containing the variables in the formula. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;strong&gt;method&lt;/strong&gt;: the type of test. Default is &lt;em&gt;“wilcox.test”&lt;/em&gt;. Allowed values include: &lt;ul&gt; &lt;li&gt; &lt;em&gt;“t.test”&lt;/em&gt; (parametric) and &lt;em&gt;“wilcox.test”&lt;/em&gt;&quot; (non-parametric). Perform comparison between two groups of samples. If the grouping variable contains more than two levels, then a pairwise comparison is performed. &lt;/li&gt; &lt;li&gt; &lt;em&gt;“anova”&lt;/em&gt; (parametric) and &lt;em&gt;“kruskal.test”&lt;/em&gt; (non-parametric). Perform one-way ANOVA test comparing multiple groups. &lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;paired&lt;/strong&gt;: a logical indicating whether you want a paired test. Used only in &lt;em&gt;t.test&lt;/em&gt; and in &lt;em&gt;wilcox.test&lt;/em&gt;. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;group.by&lt;/strong&gt;: variables used to group the data set before applying the test. When specified the mean comparisons will be performed in each subset of the data formed by the different levels of the group.by variables. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;ref.group&lt;/strong&gt;: a character string specifying the reference group. If specified, for a given grouping variable, each of the group levels will be compared to the reference group (i.e. control group). ref.group can be also &lt;em&gt;“.all.”&lt;/em&gt;. In this case, each of the grouping variable levels is compared to all (i.e. base-mean). &lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level3&quot;&gt; &lt;h3&gt;stat_compare_means()&lt;/h3&gt; &lt;p&gt;This function extends ggplot2 for adding mean comparison p-values to a ggplot, such as box blots, dot plots, bar plots and line plots.&lt;/p&gt; &lt;p&gt;The simplified format is as follow:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;stat_compare_means(mapping = NULL, comparisons = NULL hide.ns = FALSE,                    label = NULL,  label.x = NULL, label.y = NULL,  ...)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;block&quot;&gt; &lt;ul&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;mapping&lt;/strong&gt;: Set of aesthetic mappings created by aes(). &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;comparisons&lt;/strong&gt;: A list of length-2 vectors. The entries in the vector are either the names of 2 values on the x-axis or the 2 integers that correspond to the index of the groups of interest, to be compared. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;hide.ns&lt;/strong&gt;: logical value. If TRUE, hide ns symbol when displaying significance levels. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;label&lt;/strong&gt;: character string specifying label type. Allowed values include “p.signif” (shows the significance levels), “p.format” (shows the formatted p value). &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;label.x,label.y&lt;/strong&gt;: numeric values. coordinates (in data units) to be used for absolute positioning of the label. If too short they will be recycled. &lt;/p&gt; &lt;/li&gt; &lt;li&gt; &lt;p&gt; &lt;strong&gt;…&lt;/strong&gt;: other arguments passed to the function &lt;strong&gt;compare_means&lt;/strong&gt;() such as &lt;em&gt;method&lt;/em&gt;, &lt;em&gt;paired&lt;/em&gt;, &lt;em&gt;ref.group&lt;/em&gt;. &lt;/p&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare two independent groups&lt;/h2&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 8     .y. group1 group2          p      p.adj p.format p.signif   method    1   len     OJ     VC 0.06449067 0.06449067    0.064       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; By default &lt;strong&gt;method = “wilcox.test”&lt;/strong&gt; (non-parametric test). You can also specify &lt;strong&gt;method = “t.test”&lt;/strong&gt; for a parametric t-test. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Returned value is a data frame with the following columns:&lt;/p&gt; &lt;ul&gt; &lt;li&gt;.y.: the y variable used in the test.&lt;/li&gt; &lt;li&gt;p: the p-value&lt;/li&gt; &lt;li&gt;p.adj: the adjusted p-value. Default value for p.adjust.method = “holm”&lt;/li&gt; &lt;li&gt;p.format: the formatted p-value&lt;/li&gt; &lt;li&gt;p.signif: the significance level.&lt;/li&gt; &lt;li&gt;method: the statistical test used to compare groups.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Create a box plot with p-values:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Note that, the p-value label position can be adjusted using the arguments: &lt;em&gt;label.x, label.y, hjust and vjust&lt;/em&gt;.&lt;/p&gt; &lt;p&gt;The default p-value label displayed is obtained by concatenating the &lt;strong&gt;method&lt;/strong&gt; and the &lt;strong&gt;p&lt;/strong&gt; columns of the returned data frame by the function &lt;strong&gt;compare_means&lt;/strong&gt;(). You can specify other combinations using the &lt;strong&gt;aes&lt;/strong&gt;() function.&lt;/p&gt; &lt;p&gt;For example,&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;aes(label = ..p.format..)&lt;/strong&gt; or &lt;strong&gt;aes(label = paste0(“p =”, ..p.format..))&lt;/strong&gt;: display only the formatted p-value (without the method name)&lt;/li&gt; &lt;li&gt; &lt;strong&gt;aes(label = ..p.signif..)&lt;/strong&gt;: display only the significance level.&lt;/li&gt; &lt;li&gt; &lt;strong&gt;aes(label = paste0(..method.., “\n”, “p =”, ..p.format..))&lt;/strong&gt;: Use line break (“\n”) between the method name and the p-value.&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;As an illustration, type this:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p + stat_compare_means( aes(label = ..p.signif..),                          label.x = 1.5, label.y = 40)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;If you prefer, it’s also possible to specify the argument &lt;em&gt;label&lt;/em&gt; as a character vector:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p + stat_compare_means( label = &quot;p.signif&quot;, label.x = 1.5, label.y = 40)&lt;/code&gt;&lt;/pre&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare two paired samples&lt;/h2&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth, paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 8     .y. group1 group2           p       p.adj p.format p.signif   method    1   len     OJ     VC 0.004312554 0.004312554   0.0043       ** Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Visualize paired data using the &lt;strong&gt;ggpaired&lt;/strong&gt;() function:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggpaired(ToothGrowth, x = &quot;supp&quot;, y = &quot;len&quot;,          color = &quot;supp&quot;, line.color = &quot;gray&quot;, line.size = 0.4,          palette = &quot;jco&quot;)+   stat_compare_means(paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-paired-tests-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Compare more than two groups&lt;/h2&gt; &lt;ul&gt; &lt;li&gt;Global test:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Global test compare_means(len ~ dose,  data = ToothGrowth, method = &quot;anova&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 1 x 6     .y.            p        p.adj p.format p.signif method    1   len 9.532727e-16 9.532727e-16  9.5e-16     ****  Anova&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Plot with global p-value:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Default method = &quot;kruskal.test&quot; for multiple groups ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means()  # Change method to anova ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Pairwise comparisons&lt;/strong&gt;. If the grouping variable contains more than two levels, then pairwise tests will be performed automatically. The default method is “wilcox.test”. You can change this to “t.test”.&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Perorm pairwise comparisons compare_means(len ~ dose,  data = ToothGrowth)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 8     .y. group1 group2            p        p.adj p.format p.signif   method    1   len    0.5      1 7.020855e-06 1.404171e-05  7.0e-06     **** Wilcoxon 2   len    0.5      2 8.406447e-08 2.521934e-07  8.4e-08     **** Wilcoxon 3   len      1      2 1.772382e-04 1.772382e-04  0.00018      *** Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize: Specify the comparisons you want my_comparisons &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;If you want to specify the precise y location of bars, use the argument &lt;strong&gt;label.y&lt;/strong&gt;:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+    stat_compare_means(comparisons = my_comparisons, label.y = c(29, 35, 40))+   stat_compare_means(label.y = 45)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;(Adding bars, connecting compared groups, has been facilitated by the &lt;a href=&quot;https://github.com/Artjom-Metro/ggsignif&quot;&gt;ggsignif&lt;/a&gt; R package )&lt;/p&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Multiple pairwise tests against a reference group&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Pairwise comparison against reference compare_means(len ~ dose,  data = ToothGrowth, ref.group = &quot;0.5&quot;,               method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 2 x 8     .y. group1 group2            p        p.adj p.format p.signif method    1   len    0.5      1 6.697250e-09 6.697250e-09  6.7e-09     **** T-test 2   len    0.5      2 1.469534e-16 2.939068e-16  &lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;, label.y = 40)+      # Add global p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;0.5&quot;)                    # Pairwise comparison against reference&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-reference-group-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Multiple pairwise tests against all (base-mean)&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Comparison of each group against base-mean compare_means(len ~ dose,  data = ToothGrowth, ref.group = &quot;.all.&quot;,               method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 8     .y. group1 group2            p        p.adj p.format p.signif method    1   len  .all.    0.5 1.244626e-06 3.733877e-06  1.2e-06     **** T-test 2   len  .all.      1 5.667266e-01 5.667266e-01     0.57       ns T-test 3   len  .all.      2 1.371704e-05 2.743408e-05  1.4e-05     **** T-test&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize ggboxplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;,           color = &quot;dose&quot;, palette = &quot;jco&quot;)+   stat_compare_means(method = &quot;anova&quot;, label.y = 40)+      # Add global p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;)                  # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;480&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;p&gt;A typical situation, where pairwise comparisons against “all” can be useful, is illustrated here using the &lt;em&gt;myeloma&lt;/em&gt; data set from the &lt;a href=&quot;https://github.com/kassambara/survminer&quot;&gt;&lt;strong&gt;survminer&lt;/strong&gt;&lt;/a&gt; package.&lt;/p&gt; &lt;p&gt;We’ll plot the expression profile of the DEPDC1 gene according to the patients’ molecular groups. We want to know if there is any difference between groups. If yes, where the difference is?&lt;/p&gt; &lt;p&gt;To answer to this question, you can perform a pairwise comparison between all the 7 groups. This will lead to a lot of comparisons between all possible combinations. If you have many groups, as here, it might be difficult to interpret.&lt;/p&gt; &lt;p&gt;Another easy solution is to compare each of the seven groups against “all” (i.e. base-mean). When the test is significant, then you can conclude that DEPDC1 is significantly overexpressed or downexpressed in a group xxx compared to all.&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Load myeloma data from survminer package if(!require(survminer)) install.packages(&quot;survminer&quot;) data(&quot;myeloma&quot;, package = &quot;survminer&quot;)  # Perform the test compare_means(DEPDC1 ~ molecular_group,  data = myeloma,               ref.group = &quot;.all.&quot;, method = &quot;t.test&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 7 x 8      .y. group1           group2            p        p.adj p.format p.signif method     1 DEPDC1  .all.       Cyclin D-1 1.496896e-01 4.490687e-01  0.14969       ns T-test 2 DEPDC1  .all.       Cyclin D-2 5.231428e-01 1.000000e+00  0.52314       ns T-test 3 DEPDC1  .all.     Hyperdiploid 2.815333e-04 1.689200e-03  0.00028      *** T-test 4 DEPDC1  .all. Low bone disease 5.083985e-03 2.541992e-02  0.00508       ** T-test 5 DEPDC1  .all.              MAF 8.610664e-02 3.444265e-01  0.08611       ns T-test 6 DEPDC1  .all.            MMSET 5.762908e-01 1.000000e+00  0.57629       ns T-test 7 DEPDC1  .all.    Proliferation 1.241416e-09 8.689910e-09  1.2e-09     **** T-test&lt;/code&gt;&lt;/pre&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize the expression profile ggboxplot(myeloma, x = &quot;molecular_group&quot;, y = &quot;DEPDC1&quot;, color = &quot;molecular_group&quot;,            add = &quot;jitter&quot;, legend = &quot;none&quot;) +   rotate_x_text(angle = 45)+   geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean   stat_compare_means(method = &quot;anova&quot;, label.y = 1600)+        # Add global annova p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;)                      # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean2-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;success&quot;&gt; &lt;p&gt; From the plot above, we can conclude that DEPDC1 is significantly overexpressed in proliferation group and, it’s significantly downexpressed in Hyperdiploid and Low bone disease compared to all. &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; Note that, if you want to hide the ns symbol, specify the argument &lt;em&gt;hide.ns = TRUE&lt;/em&gt;. &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Visualize the expression profile ggboxplot(myeloma, x = &quot;molecular_group&quot;, y = &quot;DEPDC1&quot;, color = &quot;molecular_group&quot;,            add = &quot;jitter&quot;, legend = &quot;none&quot;) +   rotate_x_text(angle = 45)+   geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean   stat_compare_means(method = &quot;anova&quot;, label.y = 1600)+        # Add global annova p-value   stat_compare_means(label = &quot;p.signif&quot;, method = &quot;t.test&quot;,                      ref.group = &quot;.all.&quot;, hide.ns = TRUE)      # Pairwise comparison against all&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Multiple grouping variables&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Two independent sample comparisons after grouping the data by another variable&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth,                group.by = &quot;dose&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 9    dose   .y. group1 group2           p      p.adj p.format p.signif   method    1   0.5   len     OJ     VC 0.023186427 0.04637285    0.023        * Wilcoxon 2   1.0   len     OJ     VC 0.004030367 0.01209110    0.004       ** Wilcoxon 3   2.0   len     OJ     VC 1.000000000 1.00000000    1.000       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;notice&quot;&gt; &lt;p&gt; In the example above, for each level of the variable “dose”, we compare the means of the variable “len” in the different groups formed by the grouping variable “supp”. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Visualize (1/2). Create a multi-panel box plots facetted by group (here, “dose”):&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Box plot facetted by &quot;dose&quot; p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Or use significance symbol as label p + stat_compare_means(label =  &quot;p.signif&quot;, label.x = 1.5)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;warning&quot;&gt; &lt;p&gt; To hide the ‘ns’ symbol, use the argument &lt;strong&gt;hide.ns = TRUE&lt;/strong&gt;. &lt;/p&gt; &lt;/div&gt; &lt;p&gt;Visualize (2/2). Create one single panel with all box plots. Plot y = “len” by x = “dose” and color by “supp”:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Show only p-value p + stat_compare_means(aes(group = supp), label = &quot;p.format&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Use significance symbol as label p + stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;)&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-3.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Paired sample comparisons after grouping the data by another variable&lt;/strong&gt;:&lt;/li&gt; &lt;/ul&gt; &lt;p&gt;Perform the test:&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;compare_means(len ~ supp, data = ToothGrowth,                group.by = &quot;dose&quot;, paired = TRUE)&lt;/code&gt;&lt;/pre&gt; &lt;pre&gt;&lt;code&gt;# A tibble: 3 x 9    dose   .y. group1 group2          p      p.adj p.format p.signif   method    1   0.5   len     OJ     VC 0.03296938 0.06593876    0.033        * Wilcoxon 2   1.0   len     OJ     VC 0.01905889 0.05717667    0.019        * Wilcoxon 3   2.0   len     OJ     VC 1.00000000 1.00000000    1.000       ns Wilcoxon&lt;/code&gt;&lt;/pre&gt; &lt;p&gt;Visualize. Create a multi-panel box plots facetted by group (here, “dose”):&lt;/p&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Box plot facetted by &quot;dose&quot; p &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-paired-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;672&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Other plot types&lt;/h2&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Bar and line plots&lt;/strong&gt; (one grouping variable):&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;# Bar plot of mean +/-se ggbarplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;)+   stat_compare_means() +                                         # Global p-value   stat_compare_means(ref.group = &quot;0.5&quot;, label = &quot;p.signif&quot;,                      label.y = c(22, 29))                   # compare to ref.group  # Line plot of mean +/-se ggline(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;)+   stat_compare_means() +                                         # Global p-value   stat_compare_means(ref.group = &quot;0.5&quot;, label = &quot;p.signif&quot;,                      label.y = c(22, 29))     &lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;ul&gt; &lt;li&gt; &lt;strong&gt;Bar and line plots&lt;/strong&gt; (two grouping variables):&lt;/li&gt; &lt;/ul&gt; &lt;pre class=&quot;r&quot;&gt;&lt;code&gt;ggbarplot(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;,           color = &quot;supp&quot;, palette = &quot;jco&quot;,            position = position_dodge(0.8))+   stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;, label.y = 29)  ggline(ToothGrowth, x = &quot;dose&quot;, y = &quot;len&quot;, add = &quot;mean_se&quot;,           color = &quot;supp&quot;, palette = &quot;jco&quot;)+   stat_compare_means(aes(group = supp), label = &quot;p.signif&quot;,                       label.y = c(16, 25, 29))&lt;/code&gt;&lt;/pre&gt; &lt;div class=&quot;figure&quot;&gt; &lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-1.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;img src=&quot;http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png&quot; alt=&quot;Add p-values and significance levels to ggplots&quot; width=&quot;355.2&quot;&gt;&lt;p class=&quot;caption&quot;&gt; Add p-values and significance levels to ggplots &lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;section level2&quot;&gt; &lt;h2&gt;Infos&lt;/h2&gt; &lt;p&gt;This analysis has been performed using &lt;strong&gt;R software&lt;/strong&gt; (ver. 3.3.2) and &lt;strong&gt;ggpubr&lt;/strong&gt; (ver. 0.1.3).&lt;/p&gt; &lt;/div&gt;  &lt;/div&gt; &lt;!--end rdoc--&gt; &lt;!--====================== stop here when you copy to sthda================--&gt;   &lt;!-- END HTML --&gt;">
<meta name="twitter:site" content="@Rbloggers">
<!-- Twitter Card generated by MashShare 3.4.2 - https://www.mashshare.net -->


<!-- All in One SEO Pack 2.3.13.2 by Michael Torbert of Semper Fi Web Design[372,441] -->
<meta name="description"  content="In this article, we’ll describe how to easily i) compare means of two or multiple groups; ii) and to automatically add p-values and significance levels to a" />

<link rel="canonical" href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" />
<!-- /all in one seo pack -->
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s.w.org' />
		<script type="text/rocketscript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.r-bloggers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.6.1"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='snp_styles_reset-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/themes/reset.min.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox2-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/fancybox2/jquery.fancybox.min.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='snp_styles_theme6-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/themes/theme6/css/theme6.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://www.r-bloggers.com/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.4.2' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}@media only screen and (min-width:568px){.mashsb-buttons a {min-width: 177px;}}
</style>
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='https://www.r-bloggers.com/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=4.6.1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://www.r-bloggers.com/wp-content/plugins/jetpack/css/jetpack.css?ver=4.7.1' type='text/css' media='all' />
<link rel='stylesheet' id='codebox-css'  href='https://www.r-bloggers.com/wp-content/plugins/wp-codebox/css/codebox.css?ver=0.1' type='text/css' media='screen' />
<!-- This site uses the Google Analytics by MonsterInsights plugin v6.2.0 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	var disableStr = 'ga-disable-UA-419807-53';
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-419807-53', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script>
<!-- / Google Analytics by MonsterInsights -->
<script type="text/rocketscript" data-rocketsrc="//ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/rocketscript">try{jQuery.noConflict();}catch(e){};</script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script>
<script type="text/rocketscript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/related-posts/related-posts.js?ver=20150408"></script>
<script type="text/rocketscript">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","is_debug_mode":"false","download_extensions":"doc,exe,js,pdf,ppt,tgz,zip,xls","inbound_paths":"","home_url":"https:\/\/www.r-bloggers.com","track_download_as":"event","internal_label":"int","hash_tracking":"false"};
/* ]]> */
</script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/google-analytics-for-wordpress/assets/js/frontend.min.js?ver=6.2.0"></script>
<script type="text/rocketscript">
/* <![CDATA[ */
var mashsb = {"shares":"264","round_shares":"1","animate_shares":"0","dynamic_buttons":"0","share_url":"https:\/\/www.r-bloggers.com\/add-p-values-and-significance-levels-to-ggplots\/","title":"Add+P-values+and+Significance+Levels+to+ggplots","image":null,"desc":"\n<!-- START HTML -->\n\n  <!--====================== start from here when you copy to sthda================-->  \n  <div>\n\n<p><br><\/p>\n<p>In this article, we\u2019ll describe how to easily i) <strong>compare means<\/strong> of two or multiple groups; ii) and to automatically add <strong>p-values<\/strong> and <strong>significance levels<\/strong> to a ggplot (such as box plots, dot plots, bar plots and line plots \u2026).<\/p>\n<p><strong>Contents<\/strong>:<\/p>\n\n<div>\n<ul>\n<li><a href=\"http:\/\/www.sthda.com\/#prerequisites\">Prerequisites<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#methods-for-comparing-means\">Methods for comparing means<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#r-functions-to-add-p-values\">R functions to add p-values<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#compare-two-independent-groups\">Compare two independent groups<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#compare-two-paired-samples\">Compare two paired samples<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#compare-more-than-two-groups\">Compare more than two groups<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#multiple-grouping-variables\">Multiple grouping variables<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#other-plot-types\">Other plot types<\/a><\/li>\n<li><a href=\"http:\/\/www.sthda.com\/#infos\">Infos<\/a><\/li>\n<\/ul>\n<\/div>\n \n<div class=\"section level2\">\n<h2>Prerequisites<\/h2>\n<div class=\"section level3\">\n<h3>Install and load required R packages<\/h3>\n<p>Required R package: <a href=\"http:\/\/www.sthda.com\/english\/rpkgs\/ggpubr\">ggpubr (version >= 0.1.3)<\/a>, for ggplot2-based publication ready plots.<\/p>\n<ul>\n<li>Install from <a href=\"https:\/\/cran.r-project.org\/package=ggpubr\">CRAN<\/a> as follow:<\/li>\n<\/ul>\n<pre class=\"r\"><code>install.packages(\"ggpubr\")<\/code><\/pre>\n<ul>\n<li>Or, install the latest developmental version from <a href=\"https:\/\/github.com\/kassambara\/ggpubr\">GitHub<\/a> as follow:<\/li>\n<\/ul>\n<pre class=\"r\"><code>if(!require(devtools)) install.packages(\"devtools\")\ndevtools::install_github(\"kassambara\/ggpubr\")<\/code><\/pre>\n<ul>\n<li>Load ggpubr:<\/li>\n<\/ul>\n<pre class=\"r\"><code>library(ggpubr)<\/code><\/pre>\n<div class=\"success\">\n<p>\nOfficial documentation of ggpubr is available at: <a href=\"http:\/\/www.sthda.com\/english\/rpkgs\/ggpubr\" class=\"uri\">http:\/\/www.sthda.com\/english\/rpkgs\/ggpubr<\/a>\n<\/p>\n<\/div>\n<\/div>\n<div class=\"section level3\">\n<h3>Demo data sets<\/h3>\n<p>Data: <a href=\"http:\/\/www.sthda.com\/english\/wiki\/r-built-in-data-sets#toothgrowth\">ToothGrowth<\/a> data sets.<\/p>\n<pre class=\"r\"><code>data(\"ToothGrowth\")\nhead(ToothGrowth)<\/code><\/pre>\n<pre><code>   len supp dose\n1  4.2   VC  0.5\n2 11.5   VC  0.5\n3  7.3   VC  0.5\n4  5.8   VC  0.5\n5  6.4   VC  0.5\n6 10.0   VC  0.5<\/code><\/pre>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Methods for comparing means<\/h2>\n<p>The standard methods to compare the means of two or more groups in R, have been largely described at: <a href=\"http:\/\/www.sthda.com\/english\/wiki\/comparing-means-in-r\">comparing means in R<\/a>.<\/p>\n<p>The most common methods for comparing means include:<\/p>\n<table>\n<thead><tr class=\"header\">\n<th>Methods<\/th>\n<th>R function<\/th>\n<th>Description<\/th>\n<\/tr><\/thead>\n<tbody>\n<tr class=\"odd\">\n<td>T-test<\/td>\n<td>t.test()<\/td>\n<td>Compare two groups (parametric)<\/td>\n<\/tr>\n<tr class=\"even\">\n<td>Wilcoxon test<\/td>\n<td>wilcox.test()<\/td>\n<td>Compare two groups (non-parametric)<\/td>\n<\/tr>\n<tr class=\"odd\">\n<td>ANOVA<\/td>\n<td>aov() or anova()<\/td>\n<td>Compare multiple groups (parametric)<\/td>\n<\/tr>\n<tr class=\"even\">\n<td>Kruskal-Wallis<\/td>\n<td>kruskal.test()<\/td>\n<td>Compare multiple groups (non-parametric)<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>A practical guide to compute and interpret the results of each of these methods are provided at the following links:<\/p>\n<div class=\"block\">\n<ul>\n<li>\nComparing one-sample mean to a standard known mean:\n<ul>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/one-sample-t-test-in-r\">One-Sample T-test (parametric)<\/a>\n<\/li>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/one-sample-wilcoxon-signed-rank-test-in-r\">One-Sample Wilcoxon Test (non-parametric)<\/a>\n<\/li>\n<\/ul>\n<\/li>\n<li>\nComparing the means of two independent groups:\n<ul>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/unpaired-two-samples-t-test-in-r\">Unpaired Two Samples T-test (parametric)<\/a>\n<\/li>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/unpaired-two-samples-wilcoxon-test-in-r\">Unpaired Two-Samples Wilcoxon Test (non-parametric)<\/a>\n<\/li>\n<\/ul>\n<\/li>\n<li>\nComparing the means of paired samples:\n<ul>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/paired-samples-t-test-in-r\">Paired Samples T-test (parametric)<\/a>\n<\/li>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/paired-samples-wilcoxon-test-in-r\">Paired Samples Wilcoxon Test (non-parametric)<\/a>\n<\/li>\n<\/ul>\n<\/li>\n<li>\nComparing the means of more than two groups\n<ul>\n<li>\nAnalysis of variance (ANOVA, parametric):\n<ul>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/one-way-anova-test-in-r\">One-Way ANOVA Test in R<\/a>\n<\/li>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/two-way-anova-test-in-r\">Two-Way ANOVA Test in R<\/a>\n<\/li>\n<\/ul>\n<\/li>\n<li>\n<a href=\"http:\/\/www.sthda.com\/english\/wiki\/kruskal-wallis-test-in-r\">Kruskal-Wallis Test in R (non parametric alternative to one-way ANOVA)<\/a>\n<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>R functions to add p-values<\/h2>\n<p>Here we present two new R functions in the <strong>ggpubr<\/strong> package:<\/p>\n<ul>\n<li>\n<strong>compare_means<\/strong>(): easy to use solution to performs one and multiple mean comparisons.<\/li>\n<li>\n<strong>stat_compare_means<\/strong>(): easy to use solution to automatically add p-values and significance levels to a ggplot.<\/li>\n<\/ul>\n<div class=\"section level3\">\n<h3>compare_means()<\/h3>\n<p>As we\u2019ll show in the next sections, it has multiple useful options compared to the standard R functions.<\/p>\n<p>The simplified format is as follow:<\/p>\n<pre class=\"r\"><code>compare_means(formula, data, method = \"wilcox.test\", paired = FALSE,\n  group.by = NULL, ref.group = NULL, ...)<\/code><\/pre>\n<div class=\"block\">\n<ul>\n<li>\n<strong>formula<\/strong>: a formula of the form <em>x ~ group<\/em>, where x is a numeric variable and group is a factor with one or multiple levels. For example, <em>formula = TP53 ~ cancer_group<\/em>. It\u2019s also possible to perform the test for multiple response variables at the same time. For example, <em>formula = c(TP53, PTEN) ~ cancer_group<\/em>.\n<\/li>\n<li>\n<p>\n<strong>data<\/strong>: a data.frame containing the variables in the formula.\n<\/p>\n<\/li>\n<li>\n<strong>method<\/strong>: the type of test. Default is <em>\u201cwilcox.test\u201d<\/em>. Allowed values include:\n<ul>\n<li>\n<em>\u201ct.test\u201d<\/em> (parametric) and <em>\u201cwilcox.test\u201d<\/em>\" (non-parametric). Perform comparison between two groups of samples. If the grouping variable contains more than two levels, then a pairwise comparison is performed.\n<\/li>\n<li>\n<em>\u201canova\u201d<\/em> (parametric) and <em>\u201ckruskal.test\u201d<\/em> (non-parametric). Perform one-way ANOVA test comparing multiple groups.\n<\/li>\n<\/ul>\n<\/li>\n<li>\n<p>\n<strong>paired<\/strong>: a logical indicating whether you want a paired test. Used only in <em>t.test<\/em> and in <em>wilcox.test<\/em>.\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>group.by<\/strong>: variables used to group the data set before applying the test. When specified the mean comparisons will be performed in each subset of the data formed by the different levels of the group.by variables.\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>ref.group<\/strong>: a character string specifying the reference group. If specified, for a given grouping variable, each of the group levels will be compared to the reference group (i.e.\u00a0control group). ref.group can be also <em>\u201c.all.\u201d<\/em>. In this case, each of the grouping variable levels is compared to all (i.e.\u00a0base-mean).\n<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<div class=\"section level3\">\n<h3>stat_compare_means()<\/h3>\n<p>This function extends ggplot2 for adding mean comparison p-values to a ggplot, such as box blots, dot plots, bar plots and line plots.<\/p>\n<p>The simplified format is as follow:<\/p>\n<pre class=\"r\"><code>stat_compare_means(mapping = NULL, comparisons = NULL hide.ns = FALSE,\n                   label = NULL,  label.x = NULL, label.y = NULL,  ...)<\/code><\/pre>\n<div class=\"block\">\n<ul>\n<li>\n<p>\n<strong>mapping<\/strong>: Set of aesthetic mappings created by aes().\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>comparisons<\/strong>: A list of length-2 vectors. The entries in the vector are either the names of 2 values on the x-axis or the 2 integers that correspond to the index of the groups of interest, to be compared.\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>hide.ns<\/strong>: logical value. If TRUE, hide ns symbol when displaying significance levels.\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>label<\/strong>: character string specifying label type. Allowed values include \u201cp.signif\u201d (shows the significance levels), \u201cp.format\u201d (shows the formatted p value).\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>label.x,label.y<\/strong>: numeric values. coordinates (in data units) to be used for absolute positioning of the label. If too short they will be recycled.\n<\/p>\n<\/li>\n<li>\n<p>\n<strong>\u2026<\/strong>: other arguments passed to the function <strong>compare_means<\/strong>() such as <em>method<\/em>, <em>paired<\/em>, <em>ref.group<\/em>.\n<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Compare two independent groups<\/h2>\n<p>Perform the test:<\/p>\n<pre class=\"r\"><code>compare_means(len ~ supp, data = ToothGrowth)<\/code><\/pre>\n<pre><code># A tibble: 1 x 8\n    .y. group1 group2          p      p.adj p.format p.signif   method\n  \n1   len     OJ     VC 0.06449067 0.06449067    0.064       ns Wilcoxon<\/code><\/pre>\n<div class=\"warning\">\n<p>\nBy default <strong>method = \u201cwilcox.test\u201d<\/strong> (non-parametric test). You can also specify <strong>method = \u201ct.test\u201d<\/strong> for a parametric t-test.\n<\/p>\n<\/div>\n<p>Returned value is a data frame with the following columns:<\/p>\n<ul>\n<li>.y.: the y variable used in the test.<\/li>\n<li>p: the p-value<\/li>\n<li>p.adj: the adjusted p-value. Default value for p.adjust.method = \u201cholm\u201d<\/li>\n<li>p.format: the formatted p-value<\/li>\n<li>p.signif: the significance level.<\/li>\n<li>method: the statistical test used to compare groups.<\/li>\n<\/ul>\n<p>Create a box plot with p-values:<\/p>\n<pre class=\"r\"><code>p <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-two-independent-groups-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<p>Note that, the p-value label position can be adjusted using the arguments: <em>label.x, label.y, hjust and vjust<\/em>.<\/p>\n<p>The default p-value label displayed is obtained by concatenating the <strong>method<\/strong> and the <strong>p<\/strong> columns of the returned data frame by the function <strong>compare_means<\/strong>(). You can specify other combinations using the <strong>aes<\/strong>() function.<\/p>\n<p>For example,<\/p>\n<ul>\n<li>\n<strong>aes(label = ..p.format..)<\/strong> or <strong>aes(label = paste0(\u201cp =\u201d, ..p.format..))<\/strong>: display only the formatted p-value (without the method name)<\/li>\n<li>\n<strong>aes(label = ..p.signif..)<\/strong>: display only the significance level.<\/li>\n<li>\n<strong>aes(label = paste0(..method.., \u201c\\n\u201d, \u201cp =\u201d, ..p.format..))<\/strong>: Use line break (\u201c\\n\u201d) between the method name and the p-value.<\/li>\n<\/ul>\n<p>As an illustration, type this:<\/p>\n<pre class=\"r\"><code>p + stat_compare_means( aes(label = ..p.signif..), \n                        label.x = 1.5, label.y = 40)<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<p>If you prefer, it\u2019s also possible to specify the argument <em>label<\/em> as a character vector:<\/p>\n<pre class=\"r\"><code>p + stat_compare_means( label = \"p.signif\", label.x = 1.5, label.y = 40)<\/code><\/pre>\n<\/div>\n<div class=\"section level2\">\n<h2>Compare two paired samples<\/h2>\n<p>Perform the test:<\/p>\n<pre class=\"r\"><code>compare_means(len ~ supp, data = ToothGrowth, paired = TRUE)<\/code><\/pre>\n<pre><code># A tibble: 1 x 8\n    .y. group1 group2           p       p.adj p.format p.signif   method\n  \n1   len     OJ     VC 0.004312554 0.004312554   0.0043       ** Wilcoxon<\/code><\/pre>\n<p>Visualize paired data using the <strong>ggpaired<\/strong>() function:<\/p>\n<pre class=\"r\"><code>ggpaired(ToothGrowth, x = \"supp\", y = \"len\",\n         color = \"supp\", line.color = \"gray\", line.size = 0.4,\n         palette = \"jco\")+\n  stat_compare_means(paired = TRUE)<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-paired-tests-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Compare more than two groups<\/h2>\n<ul>\n<li>Global test:<\/li>\n<\/ul>\n<pre class=\"r\"><code># Global test\ncompare_means(len ~ dose,  data = ToothGrowth, method = \"anova\")<\/code><\/pre>\n<pre><code># A tibble: 1 x 6\n    .y.            p        p.adj p.format p.signif method\n  \n1   len 9.532727e-16 9.532727e-16  9.5e-16     ****  Anova<\/code><\/pre>\n<p>Plot with global p-value:<\/p>\n<pre class=\"r\"><code># Default method = \"kruskal.test\" for multiple groups\nggboxplot(ToothGrowth, x = \"dose\", y = \"len\",\n          color = \"dose\", palette = \"jco\")+\n  stat_compare_means()\n\n# Change method to anova\nggboxplot(ToothGrowth, x = \"dose\", y = \"len\",\n          color = \"dose\", palette = \"jco\")+\n  stat_compare_means(method = \"anova\")<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-multiple-independent-groups-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-multiple-independent-groups-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<ul>\n<li>\n<strong>Pairwise comparisons<\/strong>. If the grouping variable contains more than two levels, then pairwise tests will be performed automatically. The default method is \u201cwilcox.test\u201d. You can change this to \u201ct.test\u201d.<\/li>\n<\/ul>\n<pre class=\"r\"><code># Perorm pairwise comparisons\ncompare_means(len ~ dose,  data = ToothGrowth)<\/code><\/pre>\n<pre><code># A tibble: 3 x 8\n    .y. group1 group2            p        p.adj p.format p.signif   method\n  \n1   len    0.5      1 7.020855e-06 1.404171e-05  7.0e-06     **** Wilcoxon\n2   len    0.5      2 8.406447e-08 2.521934e-07  8.4e-08     **** Wilcoxon\n3   len      1      2 1.772382e-04 1.772382e-04  0.00018      *** Wilcoxon<\/code><\/pre>\n<pre class=\"r\"><code># Visualize: Specify the comparisons you want\nmy_comparisons <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-pairwise-comparisons-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"480\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<p>If you want to specify the precise y location of bars, use the argument <strong>label.y<\/strong>:<\/p>\n<pre class=\"r\"><code>ggboxplot(ToothGrowth, x = \"dose\", y = \"len\",\n          color = \"dose\", palette = \"jco\")+ \n  stat_compare_means(comparisons = my_comparisons, label.y = c(29, 35, 40))+\n  stat_compare_means(label.y = 45)<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"480\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<p>(Adding bars, connecting compared groups, has been facilitated by the <a href=\"https:\/\/github.com\/Artjom-Metro\/ggsignif\">ggsignif<\/a> R package )<\/p>\n<ul>\n<li>\n<strong>Multiple pairwise tests against a reference group<\/strong>:<\/li>\n<\/ul>\n<pre class=\"r\"><code># Pairwise comparison against reference\ncompare_means(len ~ dose,  data = ToothGrowth, ref.group = \"0.5\",\n              method = \"t.test\")<\/code><\/pre>\n<pre><code># A tibble: 2 x 8\n    .y. group1 group2            p        p.adj p.format p.signif method\n  \n1   len    0.5      1 6.697250e-09 6.697250e-09  6.7e-09     **** T-test\n2   len    0.5      2 1.469534e-16 2.939068e-16  <\/code><\/pre>\n<pre class=\"r\"><code># Visualize\nggboxplot(ToothGrowth, x = \"dose\", y = \"len\",\n          color = \"dose\", palette = \"jco\")+\n  stat_compare_means(method = \"anova\", label.y = 40)+      # Add global p-value\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \"0.5\")                    # Pairwise comparison against reference<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-reference-group-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"480\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<ul>\n<li>\n<strong>Multiple pairwise tests against all (base-mean)<\/strong>:<\/li>\n<\/ul>\n<pre class=\"r\"><code># Comparison of each group against base-mean\ncompare_means(len ~ dose,  data = ToothGrowth, ref.group = \".all.\",\n              method = \"t.test\")<\/code><\/pre>\n<pre><code># A tibble: 3 x 8\n    .y. group1 group2            p        p.adj p.format p.signif method\n  \n1   len  .all.    0.5 1.244626e-06 3.733877e-06  1.2e-06     **** T-test\n2   len  .all.      1 5.667266e-01 5.667266e-01     0.57       ns T-test\n3   len  .all.      2 1.371704e-05 2.743408e-05  1.4e-05     **** T-test<\/code><\/pre>\n<pre class=\"r\"><code># Visualize\nggboxplot(ToothGrowth, x = \"dose\", y = \"len\",\n          color = \"dose\", palette = \"jco\")+\n  stat_compare_means(method = \"anova\", label.y = 40)+      # Add global p-value\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \".all.\")                  # Pairwise comparison against all<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-comparison-against-base-mean-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"480\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<p>A typical situation, where pairwise comparisons against \u201call\u201d can be useful, is illustrated here using the <em>myeloma<\/em> data set from the <a href=\"https:\/\/github.com\/kassambara\/survminer\"><strong>survminer<\/strong><\/a> package.<\/p>\n<p>We\u2019ll plot the expression profile of the DEPDC1 gene according to the patients\u2019 molecular groups. We want to know if there is any difference between groups. If yes, where the difference is?<\/p>\n<p>To answer to this question, you can perform a pairwise comparison between all the 7 groups. This will lead to a lot of comparisons between all possible combinations. If you have many groups, as here, it might be difficult to interpret.<\/p>\n<p>Another easy solution is to compare each of the seven groups against \u201call\u201d (i.e.\u00a0base-mean). When the test is significant, then you can conclude that DEPDC1 is significantly overexpressed or downexpressed in a group xxx compared to all.<\/p>\n<pre class=\"r\"><code># Load myeloma data from survminer package\nif(!require(survminer)) install.packages(\"survminer\")\ndata(\"myeloma\", package = \"survminer\")\n\n# Perform the test\ncompare_means(DEPDC1 ~ molecular_group,  data = myeloma,\n              ref.group = \".all.\", method = \"t.test\")<\/code><\/pre>\n<pre><code># A tibble: 7 x 8\n     .y. group1           group2            p        p.adj p.format p.signif method\n   \n1 DEPDC1  .all.       Cyclin D-1 1.496896e-01 4.490687e-01  0.14969       ns T-test\n2 DEPDC1  .all.       Cyclin D-2 5.231428e-01 1.000000e+00  0.52314       ns T-test\n3 DEPDC1  .all.     Hyperdiploid 2.815333e-04 1.689200e-03  0.00028      *** T-test\n4 DEPDC1  .all. Low bone disease 5.083985e-03 2.541992e-02  0.00508       ** T-test\n5 DEPDC1  .all.              MAF 8.610664e-02 3.444265e-01  0.08611       ns T-test\n6 DEPDC1  .all.            MMSET 5.762908e-01 1.000000e+00  0.57629       ns T-test\n7 DEPDC1  .all.    Proliferation 1.241416e-09 8.689910e-09  1.2e-09     **** T-test<\/code><\/pre>\n<pre class=\"r\"><code># Visualize the expression profile\nggboxplot(myeloma, x = \"molecular_group\", y = \"DEPDC1\", color = \"molecular_group\", \n          add = \"jitter\", legend = \"none\") +\n  rotate_x_text(angle = 45)+\n  geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean\n  stat_compare_means(method = \"anova\", label.y = 1600)+        # Add global annova p-value\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \".all.\")                      # Pairwise comparison against all<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-comparison-against-base-mean2-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<div class=\"success\">\n<p>\nFrom the plot above, we can conclude that DEPDC1 is significantly overexpressed in proliferation group and, it\u2019s significantly downexpressed in Hyperdiploid and Low bone disease compared to all.\n<\/p>\n<\/div>\n<div class=\"warning\">\n<p>\nNote that, if you want to hide the ns symbol, specify the argument <em>hide.ns = TRUE<\/em>.\n<\/p>\n<\/div>\n<pre class=\"r\"><code># Visualize the expression profile\nggboxplot(myeloma, x = \"molecular_group\", y = \"DEPDC1\", color = \"molecular_group\", \n          add = \"jitter\", legend = \"none\") +\n  rotate_x_text(angle = 45)+\n  geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean\n  stat_compare_means(method = \"anova\", label.y = 1600)+        # Add global annova p-value\n  stat_compare_means(label = \"p.signif\", method = \"t.test\",\n                     ref.group = \".all.\", hide.ns = TRUE)      # Pairwise comparison against all<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Multiple grouping variables<\/h2>\n<ul>\n<li>\n<strong>Two independent sample comparisons after grouping the data by another variable<\/strong>:<\/li>\n<\/ul>\n<p>Perform the test:<\/p>\n<pre class=\"r\"><code>compare_means(len ~ supp, data = ToothGrowth, \n              group.by = \"dose\")<\/code><\/pre>\n<pre><code># A tibble: 3 x 9\n   dose   .y. group1 group2           p      p.adj p.format p.signif   method\n  \n1   0.5   len     OJ     VC 0.023186427 0.04637285    0.023        * Wilcoxon\n2   1.0   len     OJ     VC 0.004030367 0.01209110    0.004       ** Wilcoxon\n3   2.0   len     OJ     VC 1.000000000 1.00000000    1.000       ns Wilcoxon<\/code><\/pre>\n<div class=\"notice\">\n<p>\nIn the example above, for each level of the variable \u201cdose\u201d, we compare the means of the variable \u201clen\u201d in the different groups formed by the grouping variable \u201csupp\u201d.\n<\/p>\n<\/div>\n<p>Visualize (1\/2). Create a multi-panel box plots facetted by group (here, \u201cdose\u201d):<\/p>\n<pre class=\"r\"><code># Box plot facetted by \"dose\"\np <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-facet-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<pre class=\"r\"><code># Or use significance symbol as label\np + stat_compare_means(label =  \"p.signif\", label.x = 1.5)<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-facet-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<div class=\"warning\">\n<p>\nTo hide the \u2018ns\u2019 symbol, use the argument <strong>hide.ns = TRUE<\/strong>.\n<\/p>\n<\/div>\n<p>Visualize (2\/2). Create one single panel with all box plots. Plot y = \u201clen\u201d by x = \u201cdose\u201d and color by \u201csupp\u201d:<\/p>\n<pre class=\"r\"><code>p <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-interaction-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<pre class=\"r\"><code># Show only p-value\np + stat_compare_means(aes(group = supp), label = \"p.format\")<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-interaction-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<pre class=\"r\"><code># Use significance symbol as label\np + stat_compare_means(aes(group = supp), label = \"p.signif\")<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-compare-means-interaction-3.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<ul>\n<li>\n<strong>Paired sample comparisons after grouping the data by another variable<\/strong>:<\/li>\n<\/ul>\n<p>Perform the test:<\/p>\n<pre class=\"r\"><code>compare_means(len ~ supp, data = ToothGrowth, \n              group.by = \"dose\", paired = TRUE)<\/code><\/pre>\n<pre><code># A tibble: 3 x 9\n   dose   .y. group1 group2          p      p.adj p.format p.signif   method\n  \n1   0.5   len     OJ     VC 0.03296938 0.06593876    0.033        * Wilcoxon\n2   1.0   len     OJ     VC 0.01905889 0.05717667    0.019        * Wilcoxon\n3   2.0   len     OJ     VC 1.00000000 1.00000000    1.000       ns Wilcoxon<\/code><\/pre>\n<p>Visualize. Create a multi-panel box plots facetted by group (here, \u201cdose\u201d):<\/p>\n<pre class=\"r\"><code># Box plot facetted by \"dose\"\np <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-facet-paired-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"672\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Other plot types<\/h2>\n<ul>\n<li>\n<strong>Bar and line plots<\/strong> (one grouping variable):<\/li>\n<\/ul>\n<pre class=\"r\"><code># Bar plot of mean +\/-se\nggbarplot(ToothGrowth, x = \"dose\", y = \"len\", add = \"mean_se\")+\n  stat_compare_means() +                                         # Global p-value\n  stat_compare_means(ref.group = \"0.5\", label = \"p.signif\",\n                     label.y = c(22, 29))                   # compare to ref.group\n\n# Line plot of mean +\/-se\nggline(ToothGrowth, x = \"dose\", y = \"len\", add = \"mean_se\")+\n  stat_compare_means() +                                         # Global p-value\n  stat_compare_means(ref.group = \"0.5\", label = \"p.signif\",\n                     label.y = c(22, 29))     <\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<ul>\n<li>\n<strong>Bar and line plots<\/strong> (two grouping variables):<\/li>\n<\/ul>\n<pre class=\"r\"><code>ggbarplot(ToothGrowth, x = \"dose\", y = \"len\", add = \"mean_se\",\n          color = \"supp\", palette = \"jco\", \n          position = position_dodge(0.8))+\n  stat_compare_means(aes(group = supp), label = \"p.signif\", label.y = 29)\n\nggline(ToothGrowth, x = \"dose\", y = \"len\", add = \"mean_se\",\n          color = \"supp\", palette = \"jco\")+\n  stat_compare_means(aes(group = supp), label = \"p.signif\", \n                     label.y = c(16, 25, 29))<\/code><\/pre>\n<div class=\"figure\">\n<img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-1.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><img src=\"http:\/\/www.sthda.com\/sthda\/RDoc\/figure\/ggpubr\/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png\" alt=\"Add p-values and significance levels to ggplots\" width=\"355.2\"><p class=\"caption\">\nAdd p-values and significance levels to ggplots\n<\/p>\n<\/div>\n<\/div>\n<div class=\"section level2\">\n<h2>Infos<\/h2>\n<p>This analysis has been performed using <strong>R software<\/strong> (ver. 3.3.2) and <strong>ggpubr<\/strong> (ver. 0.1.3).<\/p>\n<\/div>\n\n<\/div>\n<!--end rdoc-->\n<!--====================== stop here when you copy to sthda================-->\n\n\n<!-- END HTML -->\n","hashtag":"Rbloggers","subscribe":"link","subscribe_url":"https:\/\/feedburner.google.com\/fb\/a\/mailverify?uri=RBloggers","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"1"};
/* ]]> */
</script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.4.2"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/wp-codebox/js/codebox.js?ver=0.1"></script>
<link rel='https://api.w.org/' href='https://www.r-bloggers.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.r-bloggers.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.r-bloggers.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='UK R Courses' href='https://www.r-bloggers.com/uk-r-courses/' />
<link rel='next' title='Deep Learning with R' href='https://www.r-bloggers.com/deep-learning-with-r/' />
<meta name="generator" content="WordPress 4.6.1" />
<link rel='shortlink' href='https://wp.me/pMm6L-DrW' />
<link rel="alternate" type="application/json+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F&#038;format=xml" />
<!-- This site is powered by Tweet, Like, Plusone and Share Plugin - http://techxt.com/tweet-like-google-1-and-share-plugin-wordpress/ -->
<style type="text/css">div.socialicons{float:left;display:block;margin-right: 10px;line-height: 1;}div.socialiconsv{line-height: 1;}div.socialicons p{margin-bottom: 0px !important;margin-top: 0px !important;padding-bottom: 0px !important;padding-top: 0px !important;}div.social4iv{background: none repeat scroll 0 0 #FFFFFF;border: 1px solid #aaa;border-radius: 3px 3px 3px 3px;box-shadow: 3px 3px 3px #DDDDDD;padding: 3px;position: fixed;text-align: center;top: 55px;width: 68px;display:none;}div.socialiconsv{padding-bottom: 5px;}</style>

<link rel='dns-prefetch' href='//i0.wp.com'>
<link rel='dns-prefetch' href='//i1.wp.com'>
<link rel='dns-prefetch' href='//i2.wp.com'>
<style type='text/css'>img#wpstats{display:none}</style><link rel="amphtml" href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/amp/" /><style type="text/css" id="syntaxhighlighteranchor"></style>

<!-- WordPress Facebook Open Graph protocol plugin (WPFBOGP v2.0.13) http://rynoweb.com/wordpress-plugins/ -->
<meta property="fb:app_id" content="143207055763488"/>
<meta property="og:image" content="https://www.r-bloggers.com/wp-content/uploads/2016/08/R_single_01-200-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-paired-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-3.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-2.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-2.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean2-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-reference-group-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-2.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-paired-tests-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png"/>
<meta property="og:image" content="http://www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png"/>
<!-- // end wpfbogp -->
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i2.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=270%2C270&#038;ssl=1" />
</head>

<body class="single single-post postid-151648 single-format-standard wpusb-position-fixed-active">
<!-- begin header -->
<div id="header">
		    	    	<a href="https://www.r-bloggers.com/" class="headerimage"><img src="https://www.r-bloggers.com/wp-content/uploads/2016/04/R_02_2016-05-01.png" alt="R-bloggers" class="aligncenter" /></a>
        <div id="description" class="aligncenter">
        R news and tutorials contributed by (750) R bloggers    </div>     
    <div class="main-navigation"><ul id="menu-top-nav" class="sf-menu"><li id="menu-item-48314" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-48314"><a href="https://www.r-bloggers.com">Home</a></li>
<li id="menu-item-92333" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-92333"><a href="https://www.r-bloggers.com/about/">About</a></li>
<li id="menu-item-50111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50111"><a href="https://feeds.feedburner.com/RBloggers">RSS</a></li>
<li id="menu-item-48313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48313"><a href="https://www.r-bloggers.com/add-your-blog/">add your blog!</a></li>
<li id="menu-item-111419" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-111419"><a href="https://www.r-bloggers.com/how-to-learn-r-2/">Learn R</a></li>
<li id="menu-item-75513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-75513"><a href="https://www.r-users.com/">R jobs</a>
<ul class="sub-menu">
	<li id="menu-item-76945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76945"><a href="https://www.r-users.com/submit-job/">Submit a new job (it&#8217;s free)</a></li>
	<li id="menu-item-76946" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76946"><a href="https://www.r-users.com/">Browse latest jobs (also free)</a></li>
</ul>
</li>
<li id="menu-item-48311" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48311"><a href="https://www.r-bloggers.com/contact-us/">Contact us</a></li>
</ul></div>
</div>
<!-- end header -->


<div id="mainwrapper">
<!-- begin sidebar -->
    <div id="sidebar">
		<div class="side-widget"><h2>Welcome!</h2>			<div class="textwidget"><iframe allowtransparency="true" frameborder="0" scrolling="no"
 src="//platform.twitter.com/widgets/follow_button.html?screen_name=rbloggers&data-show-count"
  style="width:164px; height:30px;"></iframe>


Here you will find daily <strong>news and tutorials about R</strong>, contributed by over 750 bloggers. 
<br/>
There are many ways to <strong>follow us - </strong>
<br/>
<a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers">By e-mail:</a>

<form style="border:1px solid #ccc;padding:3px;text-align:center; background: none repeat scroll 0 0 #FDEADA;" action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open('https://feedburner.google.com/fb/a/mailverify?uri=RBloggers', 'popupwindow', 'scrollbars=yes,width=550,height=520');return true">
<input type="text" style="width:110px"  onclick="if (this.value == 'Your e-mail here') this.value = '';" value='Your e-mail here' name="email"/>
<input type="hidden" value="RBloggers" name="uri"/><input type="hidden" name="loc" value="en_US"/><input type="submit" value="Subscribe" />
<a href="https://feeds.feedburner.com/RBloggers"><img src="https://feeds.feedburner.com/~fc/RBloggers?bg=99CCFF&amp;fg=444444&amp;anim=0" height="26" width="88" style="border:0" alt="" /></a>
</form>



<a href="https://www.facebook.com/rbloggers">On Facebook:</a>
<iframe src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FR-bloggers%2F191414254890&amp;width=160&amp;height=298&amp;show_faces=true&amp;colorscheme=light&amp;stream=false&amp;border_color&amp;header=false&amp;appId=400430016676958" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:160px; height:238px;" allowTransparency="true"></iframe>


<br/>
<strong>If you are an R blogger yourself</strong> you are invited to <a href="https://www.r-bloggers.com/add-your-blog/">add your own R content feed to this site</a> (<strong>Non-English</strong> R bloggers should add themselves- <a href="https://www.r-bloggers.com/lang/add-your-blog">here</a>)</div>
		</div><div class="side-widget"><h2><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://www.r-bloggers.com/wp-includes/images/rss.png" alt="RSS" /></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R-users</a></h2><ul><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/pZpCWijuY4c/">Research and Statistical Analyst – Housing @ London, England, U.K.</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/IMLTOhbchHg/">Data Scientist @ Garching bei München, Bayern, Germany</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/4pvT8nJpoMg/">Software Developer</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/O2Cg4km53EQ/">Senior Quantitative Analyst, Data Scientist</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/vR1NRfEDFyE/">R data wrangler</a></li></ul></div><div class="side-widget"><form method="get" id="searchform" action="https://www.r-bloggers.com/">
<div>
<input type="text" class="search_input" value="Search &amp; Hit Enter" name="s" id="s" onfocus="if (this.value == 'Search &amp; Hit Enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search &amp; Hit Enter';}" />
<input type="hidden" id="searchsubmit" />
</div>
</form></div><div class="side-widget"><h2>Popular Searches</h2>
<ul>
<li><a href="https://www.r-bloggers.com/search/googlevis">googlevis</a></li>
<li><a href="https://www.r-bloggers.com/search/heatmap">heatmap</a></li>
<li><a href="https://www.r-bloggers.com/search/twitter">twitter</a></li>
<li><a href="https://www.r-bloggers.com/search/latex">latex</a></li>
<li><a href="https://www.r-bloggers.com/search/sql">sql</a></li>
<li><a href="https://www.r-bloggers.com/search/web%20Scraping">web Scraping</a></li>
<li><a href="https://www.r-bloggers.com/search/coplot">coplot</a></li>
<li><a href="https://www.r-bloggers.com/search/eof">eof</a></li>
<li><a href="https://www.r-bloggers.com/search/hadoop">hadoop</a></li>
<li><a href="https://www.r-bloggers.com/search/Jeff%20Hemsley">Jeff Hemsley</a></li>
<li><a href="https://www.r-bloggers.com/search/random%20forest">random forest</a></li>
<li><a href="https://www.r-bloggers.com/search/3%20d%20clusters">3 d clusters</a></li>
<li><a href="https://www.r-bloggers.com/search/anova">anova</a></li>
<li><a href="https://www.r-bloggers.com/search/blotter">blotter</a></li>
<li><a href="https://www.r-bloggers.com/search/boxplot">boxplot</a></li>
<li><a href="https://www.r-bloggers.com/search/decision%20tree">decision tree</a></li>
<li><a href="https://www.r-bloggers.com/search/discriminant">discriminant</a></li>
<li><a href="https://www.r-bloggers.com/search/financial">financial</a></li>
<li><a href="https://www.r-bloggers.com/search/ggplot%20background%20grid%20colour">ggplot background grid colour</a></li>
<li><a href="https://www.r-bloggers.com/search/how%20to%20import%20image%20file%20to%20r">how to import image file to r</a></li>
<li><a href="https://www.r-bloggers.com/search/maps">maps</a></li>
<li><a href="https://www.r-bloggers.com/search/purrr">purrr</a></li>
<li><a href="https://www.r-bloggers.com/search/rattle">rattle</a></li>
<li><a href="https://www.r-bloggers.com/search/Trading">Trading</a></li>
<li><a href="https://www.r-bloggers.com/search/bar%20chart">bar chart</a></li>
<li><a href="https://www.r-bloggers.com/search/barplot">barplot</a></li>
<li><a href="https://www.r-bloggers.com/search/Binary">Binary</a></li>
<li><a href="https://www.r-bloggers.com/search/climate">climate</a></li>
<li><a href="https://www.r-bloggers.com/search/contingency%20table%20data%20frame">contingency table data frame</a></li>
<li><a href="https://www.r-bloggers.com/search/data%20science">data science</a></li>
</ul>

</div>		<div class="side-widget">		<h2>Recent Posts</h2>		<ul>
					<li>
				<a href="https://www.r-bloggers.com/schedule-for-user2017-now-available/">Schedule for useR!2017 now available</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/big-data-manipulation-in-r-exercises/">Big Data Manipulation in R Exercises</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/managing-intermediate-results-when-using-rsparklyr/">Managing intermediate results when using R/sparklyr</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/unconf-projects-5-mwparser-gargle-arresteddev/">Unconf projects 5: mwparser, Gargle, arresteddev</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/r-interface-to-spark/">R Interface to Spark</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/data-science-for-business-time-series-forecasting-part-2-forecasting-with-timekit/">Data Science for Business &#8211; Time Series Forecasting Part 2: Forecasting with timekit</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/run-massive-parallel-r-jobs-cheaply-with-updated-doazureparallel-package/">Run massive parallel R jobs cheaply with updated doAzureParallel package</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/introduction-to-set-theory-and-sets-with-r/">Introduction to Set Theory and Sets with R</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/campaign-response-testing-no-longer-published-on-udemy/">Campaign Response Testing no longer published on Udemy</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/neural-networks-exercises-part-1/">Neural networks Exercises (Part-1)</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/introducing-the-montecarlo-package/">Introducing the MonteCarlo Package</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/words-growing-or-shrinking-in-hacker-news-titles-a-tidy-analysis/">Words growing or shrinking in Hacker News titles: a tidy analysis</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/test-driving-microsoft-cognitive-toolkit-in-r-using-reticulate/">Test-driving Microsoft Cognitive Toolkit in R using reticulate</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/deep-learning-with-r/">Deep Learning with R</a>
						</li>
					<li>
				<a href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/">Add P-values and Significance Levels to ggplots</a>
						</li>
				</ul>
		</div>		<div class="side-widget"><h2>Other sites</h2>
	<ul class='xoxo blogroll'>
<li><a href="http://www.proc-x.com/" title="SAS news gathered from bloggers">SAS blogs</a></li>
<li><a href="https://www.r-users.com/">Jobs for R-users</a></li>

	</ul>
</div>
    </div>
<!-- end sidebar -->	<div id="leftcontent">
	
		

	<div id="post-151648" class="post-151648 post type-post status-publish format-standard hentry category-r-bloggers">
					
				
                <h1>Add P-values and Significance Levels to ggplots</h1>
                <div class="meta"><div class="date">June 8, 2017</div>By <a href="https://www.r-bloggers.com/author/easy-guides/" title="Posts by Easy Guides" rel="author">Easy Guides</a></div><div class="entry"><p class="syndicated-attribution"><div class="social4i" style="height:29px;"><div class="social4in" style="height:29px;float: left;"><div class="socialicons s4fblike" style="float:left;margin-right: 10px;"><div class="fb-like" data-href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" data-send="true"  data-layout="button_count" data-width="100" data-height="21"  data-show-faces="false"></div></div><div class="socialicons s4linkedin" style="float:left;margin-right: 10px;"><script type="in/share" data-url="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" data-counter="right"></script></div></div><div style="clear:both"></div></div>

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
(This article was first published on  <strong><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots"> Easy Guides</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers)</a>      
</div></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-count mash-small" style="float:left;"><div class="counts mashsbcount">264</div><span class="mashsb-sharetext">SHARES</span></div><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Add%20P-values%20and%20Significance%20Levels%20to%20ggplots&url=https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/&via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.4.2--><p><!-- START HTML --></p>
<p>  <!--====================== start from here when you copy to sthda================-->  </p>
<div id="rdoc">
<p></p>
<p>In this article, we’ll describe how to easily i) <strong>compare means</strong> of two or multiple groups; ii) and to automatically add <strong>p-values</strong> and <strong>significance levels</strong> to a ggplot (such as box plots, dot plots, bar plots and line plots …).</p>
<p><strong>Contents</strong>:</p>
<div id="TOC">
<ul>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#prerequisites" rel="nofollow" target="_blank">Prerequisites</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#methods-for-comparing-means" rel="nofollow" target="_blank">Methods for comparing means</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#r-functions-to-add-p-values" rel="nofollow" target="_blank">R functions to add p-values</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#compare-two-independent-groups" rel="nofollow" target="_blank">Compare two independent groups</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#compare-two-paired-samples" rel="nofollow" target="_blank">Compare two paired samples</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#compare-more-than-two-groups" rel="nofollow" target="_blank">Compare more than two groups</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#multiple-grouping-variables" rel="nofollow" target="_blank">Multiple grouping variables</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#other-plot-types" rel="nofollow" target="_blank">Other plot types</a></li>
<li><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots#infos" rel="nofollow" target="_blank">Infos</a></li>
</ul>
</div>
<div id="prerequisites" class="section level2">
<h2>Prerequisites</h2>
<div id="install-and-load-required-r-packages" class="section level3">
<h3>Install and load required R packages</h3>
<p>Required R package: <a href="http://www.sthda.com/english/rpkgs/ggpubr" rel="nofollow" target="_blank">ggpubr (version >= 0.1.3)</a>, for ggplot2-based publication ready plots.</p>
<ul>
<li>Install from <a href="https://cran.r-project.org/package=ggpubr" rel="nofollow" target="_blank">CRAN</a> as follow:</li>
</ul>
<pre class="r"><code>install.packages("ggpubr")</code></pre>
<ul>
<li>Or, install the latest developmental version from <a href="https://github.com/kassambara/ggpubr" rel="nofollow" target="_blank">GitHub</a> as follow:</li>
</ul>
<pre class="r"><code>if(!require(devtools)) install.packages("devtools")
devtools::install_github("kassambara/ggpubr")</code></pre>
<ul>
<li>Load ggpubr:</li>
</ul>
<pre class="r"><code>library(ggpubr)</code></pre>
<div class="success">
<p>
Official documentation of ggpubr is available at: <a href="http://www.sthda.com/english/rpkgs/ggpubr" class="uri" rel="nofollow" target="_blank">http://www.sthda.com/english/rpkgs/ggpubr</a>
</p>
</div>
</div>
<div id="demo-data-sets" class="section level3">
<h3>Demo data sets</h3>
<p>Data: <a href="http://www.sthda.com/english/wiki/r-built-in-data-sets#toothgrowth" rel="nofollow" target="_blank">ToothGrowth</a> data sets.</p>
<pre class="r"><code>data("ToothGrowth")
head(ToothGrowth)</code></pre>
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
</div>
<div id="methods-for-comparing-means" class="section level2">
<h2>Methods for comparing means</h2>
<p>The standard methods to compare the means of two or more groups in R, have been largely described at: <a href="http://www.sthda.com/english/wiki/comparing-means-in-r" rel="nofollow" target="_blank">comparing means in R</a>.</p>
<p>The most common methods for comparing means include:</p>
<table>
<thead>
<tr class="header">
<th>Methods</th>
<th>R function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>T-test</td>
<td>t.test()</td>
<td>Compare two groups (parametric)</td>
</tr>
<tr class="even">
<td>Wilcoxon test</td>
<td>wilcox.test()</td>
<td>Compare two groups (non-parametric)</td>
</tr>
<tr class="odd">
<td>ANOVA</td>
<td>aov() or anova()</td>
<td>Compare multiple groups (parametric)</td>
</tr>
<tr class="even">
<td>Kruskal-Wallis</td>
<td>kruskal.test()</td>
<td>Compare multiple groups (non-parametric)</td>
</tr>
</tbody>
</table>
<p>A practical guide to compute and interpret the results of each of these methods are provided at the following links:</p>
<div class="block">
<ul>
<li>
Comparing one-sample mean to a standard known mean:</p>
<ul>
<li>
<a href="http://www.sthda.com/english/wiki/one-sample-t-test-in-r" rel="nofollow" target="_blank">One-Sample T-test (parametric)</a>
</li>
<li>
<a href="http://www.sthda.com/english/wiki/one-sample-wilcoxon-signed-rank-test-in-r" rel="nofollow" target="_blank">One-Sample Wilcoxon Test (non-parametric)</a>
</li>
</ul>
</li>
<li>
Comparing the means of two independent groups:</p>
<ul>
<li>
<a href="http://www.sthda.com/english/wiki/unpaired-two-samples-t-test-in-r" rel="nofollow" target="_blank">Unpaired Two Samples T-test (parametric)</a>
</li>
<li>
<a href="http://www.sthda.com/english/wiki/unpaired-two-samples-wilcoxon-test-in-r" rel="nofollow" target="_blank">Unpaired Two-Samples Wilcoxon Test (non-parametric)</a>
</li>
</ul>
</li>
<li>
Comparing the means of paired samples:</p>
<ul>
<li>
<a href="http://www.sthda.com/english/wiki/paired-samples-t-test-in-r" rel="nofollow" target="_blank">Paired Samples T-test (parametric)</a>
</li>
<li>
<a href="http://www.sthda.com/english/wiki/paired-samples-wilcoxon-test-in-r" rel="nofollow" target="_blank">Paired Samples Wilcoxon Test (non-parametric)</a>
</li>
</ul>
</li>
<li>
Comparing the means of more than two groups</p>
<ul>
<li>
Analysis of variance (ANOVA, parametric):</p>
<ul>
<li>
<a href="http://www.sthda.com/english/wiki/one-way-anova-test-in-r" rel="nofollow" target="_blank">One-Way ANOVA Test in R</a>
</li>
<li>
<a href="http://www.sthda.com/english/wiki/two-way-anova-test-in-r" rel="nofollow" target="_blank">Two-Way ANOVA Test in R</a>
</li>
</ul>
</li>
<li>
<a href="http://www.sthda.com/english/wiki/kruskal-wallis-test-in-r" rel="nofollow" target="_blank">Kruskal-Wallis Test in R (non parametric alternative to one-way ANOVA)</a>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="r-functions-to-add-p-values" class="section level2">
<h2>R functions to add p-values</h2>
<p>Here we present two new R functions in the <strong>ggpubr</strong> package:</p>
<ul>
<li><strong>compare_means</strong>(): easy to use solution to performs one and multiple mean comparisons.</li>
<li><strong>stat_compare_means</strong>(): easy to use solution to automatically add p-values and significance levels to a ggplot.</li>
</ul>
<div id="compare_means" class="section level3">
<h3>compare_means()</h3>
<p>As we’ll show in the next sections, it has multiple useful options compared to the standard R functions.</p>
<p>The simplified format is as follow:</p>
<pre class="r"><code>compare_means(formula, data, method = "wilcox.test", paired = FALSE,
  group.by = NULL, ref.group = NULL, ...)</code></pre>
<div class="block">
<ul>
<li>
<strong>formula</strong>: a formula of the form <em>x ~ group</em>, where x is a numeric variable and group is a factor with one or multiple levels. For example, <em>formula = TP53 ~ cancer_group</em>. It’s also possible to perform the test for multiple response variables at the same time. For example, <em>formula = c(TP53, PTEN) ~ cancer_group</em>.
</li>
<li>
<p>
<strong>data</strong>: a data.frame containing the variables in the formula.
</p>
</li>
<li>
<strong>method</strong>: the type of test. Default is <em>“wilcox.test”</em>. Allowed values include:</p>
<ul>
<li>
<em>“t.test”</em> (parametric) and <em>“wilcox.test”</em>” (non-parametric). Perform comparison between two groups of samples. If the grouping variable contains more than two levels, then a pairwise comparison is performed.
</li>
<li>
<em>“anova”</em> (parametric) and <em>“kruskal.test”</em> (non-parametric). Perform one-way ANOVA test comparing multiple groups.
</li>
</ul>
</li>
<li>
<p>
<strong>paired</strong>: a logical indicating whether you want a paired test. Used only in <em>t.test</em> and in <em>wilcox.test</em>.
</p>
</li>
<li>
<p>
<strong>group.by</strong>: variables used to group the data set before applying the test. When specified the mean comparisons will be performed in each subset of the data formed by the different levels of the group.by variables.
</p>
</li>
<li>
<p>
<strong>ref.group</strong>: a character string specifying the reference group. If specified, for a given grouping variable, each of the group levels will be compared to the reference group (i.e. control group). ref.group can be also <em>“.all.”</em>. In this case, each of the grouping variable levels is compared to all (i.e. base-mean).
</p>
</li>
</ul>
</div>
</div>
<div id="stat_compare_means" class="section level3">
<h3>stat_compare_means()</h3>
<p>This function extends ggplot2 for adding mean comparison p-values to a ggplot, such as box blots, dot plots, bar plots and line plots.</p>
<p>The simplified format is as follow:</p>
<pre class="r"><code>stat_compare_means(mapping = NULL, comparisons = NULL hide.ns = FALSE,
                   label = NULL,  label.x = NULL, label.y = NULL,  ...)</code></pre>
<div class="block">
<ul>
<li>
<p>
<strong>mapping</strong>: Set of aesthetic mappings created by aes().
</p>
</li>
<li>
<p>
<strong>comparisons</strong>: A list of length-2 vectors. The entries in the vector are either the names of 2 values on the x-axis or the 2 integers that correspond to the index of the groups of interest, to be compared.
</p>
</li>
<li>
<p>
<strong>hide.ns</strong>: logical value. If TRUE, hide ns symbol when displaying significance levels.
</p>
</li>
<li>
<p>
<strong>label</strong>: character string specifying label type. Allowed values include “p.signif” (shows the significance levels), “p.format” (shows the formatted p value).
</p>
</li>
<li>
<p>
<strong>label.x,label.y</strong>: numeric values. coordinates (in data units) to be used for absolute positioning of the label. If too short they will be recycled.
</p>
</li>
<li>
<p>
<strong>…</strong>: other arguments passed to the function <strong>compare_means</strong>() such as <em>method</em>, <em>paired</em>, <em>ref.group</em>.
</p>
</li>
</ul>
</div>
</div>
</div>
<div id="compare-two-independent-groups" class="section level2">
<h2>Compare two independent groups</h2>
<p>Perform the test:</p>
<pre class="r"><code>compare_means(len ~ supp, data = ToothGrowth)</code></pre>
<pre><code># A tibble: 1 x 8
    .y. group1 group2          p      p.adj p.format p.signif   method
  <chr>  <chr>  <chr>      <dbl>      <dbl>    <chr>    <chr>    <chr>
1   len     OJ     VC 0.06449067 0.06449067    0.064       ns Wilcoxon</code></pre>
<div class="warning">
<p>
By default <strong>method = “wilcox.test”</strong> (non-parametric test). You can also specify <strong>method = “t.test”</strong> for a parametric t-test.
</p>
</div>
<p>Returned value is a data frame with the following columns:</p>
<ul>
<li>.y.: the y variable used in the test.</li>
<li>p: the p-value</li>
<li>p.adj: the adjusted p-value. Default value for p.adjust.method = “holm”</li>
<li>p.format: the formatted p-value</li>
<li>p.signif: the significance level.</li>
<li>method: the statistical test used to compare groups.</li>
</ul>
<p>Create a box plot with p-values:</p>
<pre class="r"><code>p <- ggboxplot(ToothGrowth, x = "supp", y = "len",
          color = "supp", palette = "jco",
          add = "jitter")
#  Add p-value
p + stat_compare_means()

# Change method
p + stat_compare_means(method = "t.test")</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript><img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<p>Note that, the p-value label position can be adjusted using the arguments: <em>label.x, label.y, hjust and vjust</em>.</p>
<p>The default p-value label displayed is obtained by concatenating the <strong>method</strong> and the <strong>p</strong> columns of the returned data frame by the function <strong>compare_means</strong>(). You can specify other combinations using the <strong>aes</strong>() function.</p>
<p>For example,</p>
<ul>
<li><strong>aes(label = ..p.format..)</strong> or <strong>aes(label = paste0(“p =”, ..p.format..))</strong>: display only the formatted p-value (without the method name)</li>
<li><strong>aes(label = ..p.signif..)</strong>: display only the significance level.</li>
<li><strong>aes(label = paste0(..method.., “\n”, “p =”, ..p.format..))</strong>: Use line break (“\n”) between the method name and the p-value.</li>
</ul>
<p>As an illustration, type this:</p>
<pre class="r"><code>p + stat_compare_means( aes(label = ..p.signif..), 
                        label.x = 1.5, label.y = 40)</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-two-independent-groups-significance-level-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<p>If you prefer, it’s also possible to specify the argument <em>label</em> as a character vector:</p>
<pre class="r"><code>p + stat_compare_means( label = "p.signif", label.x = 1.5, label.y = 40)</code></pre>
</div>
<div id="compare-two-paired-samples" class="section level2">
<h2>Compare two paired samples</h2>
<p>Perform the test:</p>
<pre class="r"><code>compare_means(len ~ supp, data = ToothGrowth, paired = TRUE)</code></pre>
<pre><code># A tibble: 1 x 8
    .y. group1 group2           p       p.adj p.format p.signif   method
  <chr>  <chr>  <chr>       <dbl>       <dbl>    <chr>    <chr>    <chr>
1   len     OJ     VC 0.004312554 0.004312554   0.0043       ** Wilcoxon</code></pre>
<p>Visualize paired data using the <strong>ggpaired</strong>() function:</p>
<pre class="r"><code>ggpaired(ToothGrowth, x = "supp", y = "len",
         color = "supp", line.color = "gray", line.size = 0.4,
         palette = "jco")+
  stat_compare_means(paired = TRUE)</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-paired-tests-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-paired-tests-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
</div>
<div id="compare-more-than-two-groups" class="section level2">
<h2>Compare more than two groups</h2>
<ul>
<li>Global test:</li>
</ul>
<pre class="r"><code># Global test
compare_means(len ~ dose,  data = ToothGrowth, method = "anova")</code></pre>
<pre><code># A tibble: 1 x 6
    .y.            p        p.adj p.format p.signif method
  <chr>        <dbl>        <dbl>    <chr>    <chr>  <chr>
1   len 9.532727e-16 9.532727e-16  9.5e-16     ****  Anova</code></pre>
<p>Plot with global p-value:</p>
<pre class="r"><code># Default method = "kruskal.test" for multiple groups
ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+
  stat_compare_means()

# Change method to anova
ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+
  stat_compare_means(method = "anova")</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript><img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-multiple-independent-groups-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<ul>
<li><strong>Pairwise comparisons</strong>. If the grouping variable contains more than two levels, then pairwise tests will be performed automatically. The default method is “wilcox.test”. You can change this to “t.test”.</li>
</ul>
<pre class="r"><code># Perorm pairwise comparisons
compare_means(len ~ dose,  data = ToothGrowth)</code></pre>
<pre><code># A tibble: 3 x 8
    .y. group1 group2            p        p.adj p.format p.signif   method
  <chr>  <chr>  <chr>        <dbl>        <dbl>    <chr>    <chr>    <chr>
1   len    0.5      1 7.020855e-06 1.404171e-05  7.0e-06     **** Wilcoxon
2   len    0.5      2 8.406447e-08 2.521934e-07  8.4e-08     **** Wilcoxon
3   len      1      2 1.772382e-04 1.772382e-04  0.00018      *** Wilcoxon</code></pre>
<pre class="r"><code># Visualize: Specify the comparisons you want
my_comparisons <- list( c("0.5", "1"), c("1", "2"), c("0.5", "2") )
ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+ 
  stat_compare_means(comparisons = my_comparisons)+ # Add pairwise comparisons p-value
  stat_compare_means(label.y = 50)     # Add global p-value</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<p>If you want to specify the precise y location of bars, use the argument <strong>label.y</strong>:</p>
<pre class="r"><code>ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+ 
  stat_compare_means(comparisons = my_comparisons, label.y = c(29, 35, 40))+
  stat_compare_means(label.y = 45)</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-pairwise-comparisons-bar-location-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<p>(Adding bars, connecting compared groups, has been facilitated by the <a href="https://github.com/Artjom-Metro/ggsignif" rel="nofollow" target="_blank">ggsignif</a> R package )</p>
<ul>
<li><strong>Multiple pairwise tests against a reference group</strong>:</li>
</ul>
<pre class="r"><code># Pairwise comparison against reference
compare_means(len ~ dose,  data = ToothGrowth, ref.group = "0.5",
              method = "t.test")</code></pre>
<pre><code># A tibble: 2 x 8
    .y. group1 group2            p        p.adj p.format p.signif method
  <chr>  <chr>  <chr>        <dbl>        <dbl>    <chr>    <chr>  <chr>
1   len    0.5      1 6.697250e-09 6.697250e-09  6.7e-09     **** T-test
2   len    0.5      2 1.469534e-16 2.939068e-16  < 2e-16     **** T-test</code></pre>
<pre class="r"><code># Visualize
ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+
  stat_compare_means(method = "anova", label.y = 40)+      # Add global p-value
  stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = "0.5")                    # Pairwise comparison against reference</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-reference-group-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-reference-group-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<ul>
<li><strong>Multiple pairwise tests against all (base-mean)</strong>:</li>
</ul>
<pre class="r"><code># Comparison of each group against base-mean
compare_means(len ~ dose,  data = ToothGrowth, ref.group = ".all.",
              method = "t.test")</code></pre>
<pre><code># A tibble: 3 x 8
    .y. group1 group2            p        p.adj p.format p.signif method
  <chr>  <chr>  <chr>        <dbl>        <dbl>    <chr>    <chr>  <chr>
1   len  .all.    0.5 1.244626e-06 3.733877e-06  1.2e-06     **** T-test
2   len  .all.      1 5.667266e-01 5.667266e-01     0.57       ns T-test
3   len  .all.      2 1.371704e-05 2.743408e-05  1.4e-05     **** T-test</code></pre>
<pre class="r"><code># Visualize
ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "dose", palette = "jco")+
  stat_compare_means(method = "anova", label.y = 40)+      # Add global p-value
  stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = ".all.")                  # Pairwise comparison against all</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<p>A typical situation, where pairwise comparisons against “all” can be useful, is illustrated here using the <em>myeloma</em> data set from the <a href="https://github.com/kassambara/survminer" rel="nofollow" target="_blank"><strong>survminer</strong></a> package.</p>
<p>We’ll plot the expression profile of the DEPDC1 gene according to the patients’ molecular groups. We want to know if there is any difference between groups. If yes, where the difference is?</p>
<p>To answer to this question, you can perform a pairwise comparison between all the 7 groups. This will lead to a lot of comparisons between all possible combinations. If you have many groups, as here, it might be difficult to interpret.</p>
<p>Another easy solution is to compare each of the seven groups against “all” (i.e. base-mean). When the test is significant, then you can conclude that DEPDC1 is significantly overexpressed or downexpressed in a group xxx compared to all.</p>
<pre class="r"><code># Load myeloma data from survminer package
if(!require(survminer)) install.packages("survminer")
data("myeloma", package = "survminer")

# Perform the test
compare_means(DEPDC1 ~ molecular_group,  data = myeloma,
              ref.group = ".all.", method = "t.test")</code></pre>
<pre><code># A tibble: 7 x 8
     .y. group1           group2            p        p.adj p.format p.signif method
   <chr>  <chr>            <chr>        <dbl>        <dbl>    <chr>    <chr>  <chr>
1 DEPDC1  .all.       Cyclin D-1 1.496896e-01 4.490687e-01  0.14969       ns T-test
2 DEPDC1  .all.       Cyclin D-2 5.231428e-01 1.000000e+00  0.52314       ns T-test
3 DEPDC1  .all.     Hyperdiploid 2.815333e-04 1.689200e-03  0.00028      *** T-test
4 DEPDC1  .all. Low bone disease 5.083985e-03 2.541992e-02  0.00508       ** T-test
5 DEPDC1  .all.              MAF 8.610664e-02 3.444265e-01  0.08611       ns T-test
6 DEPDC1  .all.            MMSET 5.762908e-01 1.000000e+00  0.57629       ns T-test
7 DEPDC1  .all.    Proliferation 1.241416e-09 8.689910e-09  1.2e-09     **** T-test</code></pre>
<pre class="r"><code># Visualize the expression profile
ggboxplot(myeloma, x = "molecular_group", y = "DEPDC1", color = "molecular_group", 
          add = "jitter", legend = "none") +
  rotate_x_text(angle = 45)+
  geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean
  stat_compare_means(method = "anova", label.y = 1600)+        # Add global annova p-value
  stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = ".all.")                      # Pairwise comparison against all</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean2-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean2-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<div class="success">
<p>
From the plot above, we can conclude that DEPDC1 is significantly overexpressed in proliferation group and, it’s significantly downexpressed in Hyperdiploid and Low bone disease compared to all.
</p>
</div>
<div class="warning">
<p>
Note that, if you want to hide the ns symbol, specify the argument <em>hide.ns = TRUE</em>.
</p>
</div>
<pre class="r"><code># Visualize the expression profile
ggboxplot(myeloma, x = "molecular_group", y = "DEPDC1", color = "molecular_group", 
          add = "jitter", legend = "none") +
  rotate_x_text(angle = 45)+
  geom_hline(yintercept = mean(myeloma$DEPDC1), linetype = 2)+ # Add horizontal line at base mean
  stat_compare_means(method = "anova", label.y = 1600)+        # Add global annova p-value
  stat_compare_means(label = "p.signif", method = "t.test",
                     ref.group = ".all.", hide.ns = TRUE)      # Pairwise comparison against all</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-comparison-against-base-mean-hide-ns-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
</div>
<div id="multiple-grouping-variables" class="section level2">
<h2>Multiple grouping variables</h2>
<ul>
<li><strong>Two independent sample comparisons after grouping the data by another variable</strong>:</li>
</ul>
<p>Perform the test:</p>
<pre class="r"><code>compare_means(len ~ supp, data = ToothGrowth, 
              group.by = "dose")</code></pre>
<pre><code># A tibble: 3 x 9
   dose   .y. group1 group2           p      p.adj p.format p.signif   method
  <dbl> <chr>  <chr>  <chr>       <dbl>      <dbl>    <chr>    <chr>    <chr>
1   0.5   len     OJ     VC 0.023186427 0.04637285    0.023        * Wilcoxon
2   1.0   len     OJ     VC 0.004030367 0.01209110    0.004       ** Wilcoxon
3   2.0   len     OJ     VC 1.000000000 1.00000000    1.000       ns Wilcoxon</code></pre>
<div class="notice">
<p>
In the example above, for each level of the variable “dose”, we compare the means of the variable “len” in the different groups formed by the grouping variable “supp”.
</p>
</div>
<p>Visualize (1/2). Create a multi-panel box plots facetted by group (here, “dose”):</p>
<pre class="r"><code># Box plot facetted by "dose"
p <- ggboxplot(ToothGrowth, x = "supp", y = "len",
          color = "supp", palette = "jco",
          add = "jitter",
          facet.by = "dose", short.panel.labs = FALSE)
# Use only p.format as label. Remove method name.
p + stat_compare_means(label = "p.format")</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<pre class="r"><code># Or use significance symbol as label
p + stat_compare_means(label =  "p.signif", label.x = 1.5)</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-2.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-2.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<div class="warning">
<p>
To hide the ‘ns’ symbol, use the argument <strong>hide.ns = TRUE</strong>.
</p>
</div>
<p>Visualize (2/2). Create one single panel with all box plots. Plot y = “len” by x = “dose” and color by “supp”:</p>
<pre class="r"><code>p <- ggboxplot(ToothGrowth, x = "dose", y = "len",
          color = "supp", palette = "jco",
          add = "jitter")
p + stat_compare_means(aes(group = supp))</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<pre class="r"><code># Show only p-value
p + stat_compare_means(aes(group = supp), label = "p.format")</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-2.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-2.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<pre class="r"><code># Use significance symbol as label
p + stat_compare_means(aes(group = supp), label = "p.signif")</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-3.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-compare-means-interaction-3.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<ul>
<li><strong>Paired sample comparisons after grouping the data by another variable</strong>:</li>
</ul>
<p>Perform the test:</p>
<pre class="r"><code>compare_means(len ~ supp, data = ToothGrowth, 
              group.by = "dose", paired = TRUE)</code></pre>
<pre><code># A tibble: 3 x 9
   dose   .y. group1 group2          p      p.adj p.format p.signif   method
  <dbl> <chr>  <chr>  <chr>      <dbl>      <dbl>    <chr>    <chr>    <chr>
1   0.5   len     OJ     VC 0.03296938 0.06593876    0.033        * Wilcoxon
2   1.0   len     OJ     VC 0.01905889 0.05717667    0.019        * Wilcoxon
3   2.0   len     OJ     VC 1.00000000 1.00000000    1.000       ns Wilcoxon</code></pre>
<p>Visualize. Create a multi-panel box plots facetted by group (here, “dose”):</p>
<pre class="r"><code># Box plot facetted by "dose"
p <- ggpaired(ToothGrowth, x = "supp", y = "len",
          color = "supp", palette = "jco", 
          line.color = "gray", line.size = 0.4,
          facet.by = "dose", short.panel.labs = FALSE)
# Use only p.format as label. Remove method name.
p + stat_compare_means(label = "p.format", paired = TRUE)</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-paired-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-facet-paired-1.png?w=450" alt="Add p-values and significance levels to ggplots" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
</div>
<div id="other-plot-types" class="section level2">
<h2>Other plot types</h2>
<ul>
<li><strong>Bar and line plots</strong> (one grouping variable):</li>
</ul>
<pre class="r"><code># Bar plot of mean +/-se
ggbarplot(ToothGrowth, x = "dose", y = "len", add = "mean_se")+
  stat_compare_means() +                                         # Global p-value
  stat_compare_means(ref.group = "0.5", label = "p.signif",
                     label.y = c(22, 29))                   # compare to ref.group

# Line plot of mean +/-se
ggline(ToothGrowth, x = "dose", y = "len", add = "mean_se")+
  stat_compare_means() +                                         # Global p-value
  stat_compare_means(ref.group = "0.5", label = "p.signif",
                     label.y = c(22, 29))     </code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i0.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript><img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-one-grouping-var-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
<ul>
<li><strong>Bar and line plots</strong> (two grouping variables):</li>
</ul>
<pre class="r"><code>ggbarplot(ToothGrowth, x = "dose", y = "len", add = "mean_se",
          color = "supp", palette = "jco", 
          position = position_dodge(0.8))+
  stat_compare_means(aes(group = supp), label = "p.signif", label.y = 29)

ggline(ToothGrowth, x = "dose", y = "len", add = "mean_se",
          color = "supp", palette = "jco")+
  stat_compare_means(aes(group = supp), label = "p.signif", 
                     label.y = c(16, 25, 29))</code></pre>
<div class="figure">
<img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i2.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-1.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript><img src="https://i0.wp.com/www.r-bloggers.com/wp-content/plugins/lazy-load/images/1x1.trans.gif?ssl=1" data-lazy-src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1"><noscript><img src="https://i1.wp.com/www.sthda.com/sthda/RDoc/figure/ggpubr/add-p-values-to-ggplots-bar-line-plot-p-value-two-grouping-var-2.png?w=355" alt="Add p-values and significance levels to ggplots" .2" style="margin-bottom:10px;" data-recalc-dims="1" /></noscript></p>
<p class="caption">
Add p-values and significance levels to ggplots
</p>
</div>
</div>
<div id="infos" class="section level2">
<h2>Infos</h2>
<p>This analysis has been performed using <strong>R software</strong> (ver. 3.3.2) and <strong>ggpubr</strong> (ver. 0.1.3).</p>
</div>
<p><script type="text/rocketscript">jQuery(document).ready(function () {
    jQuery('#rdoc h1').addClass('wiki_paragraph1');
    jQuery('#rdoc h2').addClass('wiki_paragraph2');
    jQuery('#rdoc h3').addClass('wiki_paragraph3');
    jQuery('#rdoc h4').addClass('wiki_paragraph4');
    });//add phpboost class to header</script></p>
<style>.content{padding:0px;}</style>
</div>
<p><!--end rdoc--><br />
<!--====================== stop here when you copy to sthda================--></p>
<p><!-- END HTML --></p>

		<script type="text/rocketscript">
		  var vglnk = { key: '949efb41171ac6ec1bf7f206d57e90b8' };

		  (function(d, t) {
			var s = d.createElement(t); s.type = 'text/javascript'; s.async = true;
			s.src = '//cdn.viglink.com/api/vglnk.js';
			var r = d.getElementsByTagName(t)[0]; r.parentNode.insertBefore(s, r);
		  }(document, 'script'));
		</script>		
		
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-count mash-small" style="float:left;"><div class="counts mashsbcount">264</div><span class="mashsb-sharetext">SHARES</span></div><div class="mashsb-buttons"><a class="mashicon-facebook mash-small mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-small mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Add%20P-values%20and%20Significance%20Levels%20to%20ggplots&url=https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/&via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-small mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.4.2-->
<p class="syndicated-attribution">
<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="http://www.sthda.com/english/wiki/add-p-values-and-significance-levels-to-ggplots"> Easy Guides</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and <a title="R tutorials" href="https://www.r-bloggers.com/search/tutorial" rel="nofollow">tutorials</a> on topics such as: <a title="Data science" href="https://www.r-bloggers.com/search/data%20science" rel="nofollow">Data science</a>, <a title="Big Data" href="https://www.r-bloggers.com/search/Big%20Data" rel="nofollow">Big Data, <a title="R jobs" href="https://www.r-users.com/" rel="nofollow">R jobs</a>, visualization (<a title="ggplot and ggplot2 tutorials" href="https://www.r-bloggers.com/search/ggplot2" rel="nofollow">ggplot2</a>, <a title="Boxplots using lattice and ggplot2 tutorials" href="https://www.r-bloggers.com/search/boxplot" rel="nofollow">Boxplots</a>, <a title="Maps and gis" href="https://www.r-bloggers.com/search/map" rel="nofollow">maps</a>, <a title="Animation in R" href="https://www.r-bloggers.com/search/animation" rel="nofollow">animation</a>), programming (<a title="RStudio IDE for R" href="https://www.r-bloggers.com/search/RStudio" rel="nofollow">RStudio</a>, <a title="Sweave and literate programming" href="https://www.r-bloggers.com/search/sweave" rel="nofollow">Sweave</a>, <a title="LaTeX in R" href="https://www.r-bloggers.com/search/LaTeX" rel="nofollow">LaTeX</a>, <a title="SQL and databases" href="https://www.r-bloggers.com/search/SQL" rel="nofollow">SQL</a>, <a title="Eclipse IDE for R" href="https://www.r-bloggers.com/search/eclipse" rel="nofollow">Eclipse</a>, <a title="git and github, Version Control System" href="https://www.r-bloggers.com/search/git" rel="nofollow">git</a>, <a title="Large data in R using Hadoop" href="https://www.r-bloggers.com/search/hadoop" rel="nofollow">hadoop</a>, <a title="Web Scraping of google, facebook, yahoo, twitter and more using R" href="https://www.r-bloggers.com/search/Web+Scraping" rel="nofollow">Web Scraping</a>) statistics (<a title="Regressions and ANOVA analysis tutorials" href="https://www.r-bloggers.com/search/regression" rel="nofollow">regression</a>, <a title="principal component analysis tutorial" href="https://www.r-bloggers.com/search/PCA" rel="nofollow">PCA</a>, <a title="Time series" href="https://www.r-bloggers.com/search/time+series" rel="nofollow">time series</a>, <a title="finance trading" href="https://www.r-bloggers.com/search/trading" rel="nofollow">trading</a>) and more...
</div></p><hr /><hr />
<div style="border: 1px solid #EB9349; background: none repeat scroll 0 0 #FDEADA; text-align: center; margin: 10px; font-size: 16px;">
If you got this far, why not <strong><u>subscribe for updates</u> </strong>from the site?  Choose your flavor: <a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">e-mail</a>, <a href="https://twitter.com/#!/rbloggers" rel="nofollow">twitter</a>, <a href="https://feeds.feedburner.com/RBloggers" rel="nofollow">RSS</a>, or <a href="https://www.facebook.com/pages/R-bloggers/191414254890" rel="nofollow">facebook</a>...
</div><div class="social4i" style="height:29px;"><div class="social4in" style="height:29px;float: left;"><div class="socialicons s4fblike" style="float:left;margin-right: 10px;"><div class="fb-like" data-href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" data-send="true"  data-layout="button_count" data-width="100" data-height="21"  data-show-faces="false"></div></div><div class="socialicons s4linkedin" style="float:left;margin-right: 10px;"><script type="in/share" data-url="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" data-counter="right"></script></div></div><div style="clear:both"></div></div></div>

	</div><!-- #post-## -->



   				<div id="comments">


<div id="comment-user-details">





		<p class="nocomments">Comments are closed.</p>



</div>

</div><!-- #comments -->

       
	</div>
    <!-- begin second sidebar -->
    <div id="secondsidebar">

		
		<div class="side-widget"><form method="get" id="searchform" action="https://www.r-bloggers.com/">
<div>
<input type="text" class="search_input" value="Search &amp; Hit Enter" name="s" id="s" onfocus="if (this.value == 'Search &amp; Hit Enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search &amp; Hit Enter';}" />
<input type="hidden" id="searchsubmit" />
</div>
</form></div><div class="side-widget"><h2>Recent popular posts</h2><ul>				<li>
										<a href="https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/" class="bump-view" data-bump-view="tp">
						Add P-values and Significance Levels to ggplots					</a>
									</li>
							<li>
										<a href="https://www.r-bloggers.com/introducing-the-montecarlo-package/" class="bump-view" data-bump-view="tp">
						Introducing the MonteCarlo Package					</a>
									</li>
							<li>
										<a href="https://www.r-bloggers.com/introduction-to-set-theory-and-sets-with-r/" class="bump-view" data-bump-view="tp">
						Introduction to Set Theory and Sets with R					</a>
									</li>
							<li>
										<a href="https://www.r-bloggers.com/big-data-manipulation-in-r-exercises/" class="bump-view" data-bump-view="tp">
						Big Data Manipulation in R Exercises					</a>
									</li>
							<li>
										<a href="https://www.r-bloggers.com/neural-networks-exercises-part-1/" class="bump-view" data-bump-view="tp">
						Neural networks Exercises (Part-1)					</a>
									</li>
			</ul></div><div class="side-widget"><h2>Most visited articles of the week</h2>
<ol class='wppp_list'>
	<li><a href='https://www.r-bloggers.com/how-to-write-the-first-for-loop-in-r/' title='How to write the first for loop in R'>How to write the first for loop in R</a></li>
	<li><a href='https://www.r-bloggers.com/installing-r-packages/' title='Installing R packages'>Installing R packages</a></li>
	<li><a href='https://www.r-bloggers.com/using-apply-sapply-lapply-in-r/' title='Using apply, sapply, lapply in R'>Using apply, sapply, lapply in R</a></li>
	<li><a href='https://www.r-bloggers.com/how-to-learn-r-2/' title='Tutorials for learning R'>Tutorials for learning R</a></li>
	<li><a href='https://www.r-bloggers.com/how-to-make-a-histogram-with-basic-r/' title='How to Make a Histogram with Basic R'>How to Make a Histogram with Basic R</a></li>
	<li><a href='https://www.r-bloggers.com/how-to-perform-a-logistic-regression-in-r/' title='How to perform a Logistic Regression in R'>How to perform a Logistic Regression in R</a></li>
	<li><a href='https://www.r-bloggers.com/freedmans-paradox/' title='Freedman&#039;s paradox'>Freedman&#039;s paradox</a></li>
	<li><a href='https://www.r-bloggers.com/deep-learning-with-r/' title='Deep Learning with R'>Deep Learning with R</a></li>
	<li><a href='https://www.r-bloggers.com/add-p-values-and-significance-levels-to-ggplots/' title='Add P-values and Significance Levels to ggplots'>Add P-values and Significance Levels to ggplots</a></li>
</ol>
</div><div class="side-widget"><h2>Sponsors</h2>			<div class="textwidget"><script data-cfasync="false" type="text/javascript">
// https://support.cloudflare.com/hc/en-us/articles/200169436-How-can-I-have-Rocket-Loader-ignore-my-script-s-in-Automatic-Mode-
// this must be placed higher. Otherwise it doesn't work.
// data-cfasync="false" is for making sure cloudflares' rocketcache doesn't interfeare with this
// in this case it only works because it was used at the original script in the text widget


function createCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}


function readTextFile(file)
{
	// Helps people browse between pages without the need to keep downloading the same 
	// ads txt page everytime. This way, it allows them to use their browser's cache.
	var random_number = readCookie("ad_random_number_cookie");
	if(random_number == null) {
		var random_number = Math.floor(Math.random()*100*(new Date().getTime()/1000));
		createCookie("ad_random_number_cookie",random_number,1)
	}
	
    file += '?t='+random_number;
    var rawFile = new XMLHttpRequest();
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                // var allText = rawFile.responseText;
                // document.write(allText);
                document.write(rawFile.responseText);
            }
        }
    }
    rawFile.open("GET", file, false);
    rawFile.send(null);
}

// readTextFile('https://raw.githubusercontent.com/Raynos/file-store/master/temp.txt');

readTextFile("https://www.r-bloggers.com/wp-content/uploads/text-widget_anti-cache.txt");

</script>




</div>
		</div><div class="side-widget"><h2><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://www.r-bloggers.com/wp-includes/images/rss.png" alt="RSS" /></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R users</a></h2><ul><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/pZpCWijuY4c/">Research and Statistical Analyst – Housing @ London, England, U.K.</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/IMLTOhbchHg/">Data Scientist @ Garching bei München, Bayern, Germany</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/4pvT8nJpoMg/">Software Developer</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/O2Cg4km53EQ/">Senior Quantitative Analyst, Data Scientist</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/vR1NRfEDFyE/">R data wrangler</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/o12HBENqXeY/">Senior Data Scientist</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/wT5YvwCiInw/">Manager, Statistical Consulting &amp; Data Science</a></li></ul></div><div class="side-widget"><form method="get" id="searchform" action="https://www.r-bloggers.com/">
<div>
<input type="text" class="search_input" value="Search &amp; Hit Enter" name="s" id="s" onfocus="if (this.value == 'Search &amp; Hit Enter') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search &amp; Hit Enter';}" />
<input type="hidden" id="searchsubmit" />
</div>
</form></div><div class="side-widget">			<div class="textwidget"><strong><a href="https://www.r-bloggers.com/blogs-list/">Full list of contributing R-bloggers</a></strong></div>
		</div>    </div>
<!-- end second sidebar --></div>
<!-- begin footer -->
<div id="footer">
	<strong><a href="https://www.r-bloggers.com">R-bloggers</a></strong> was founded by <a href="http://www.r-statistics.com/about/">Tal Galili</a>, with gratitude to the <a href="https://www.r-project.org/">R</a> community.  <br />
    Is powered by <a href="https://www.wordpress.org">WordPress</a> using a <a href="http://themes.bavotasan.com" rel="nofollow">bavotasan.com</a> design.<br />
    Copyright &copy; 2017 <strong>R-bloggers</strong>. All Rights Reserved. <a href="https://www.r-bloggers.com/terms/">Terms and Conditions</a> for this website<br />
</div>

<!--
TPC! Memory Usage (http://webjawns.com)
Memory Usage: 63558784Memory Peak Usage: 64534560WP Memory Limit: 820MPHP Memory Limit: 512MCheckpoints: 11-->

		<div class="wpusb wpusb-buttons wpusb-fixed-right   wpusb-fixed wpusb-layout-buttons-content wpusb-fixed-position_fixed"
		     id="wpusb-container-fixed"
		     data-element-url="https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share"
		     data-element-title="Add%20P-values%20and%20Significance%20Levels%20to%20ggplots"
		     data-attr-reference="151648"
		     data-is-term="0"
		     data-element="fixed"
		     data-attr-nonce="21dfcc658f"
		      data-disabled-share-counts="1" data-wpusb-component="counter-social-share">

			<div data-element="buttons" class="wpusb-fixed-right-container ">
						<div class="wpusb-item wpusb-facebook ">

				<a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share" target="_blank"
				   data-action="open-popup"
				   class="wpusb-layout-buttons wpusb-button wpusb-btn "
				   title="Share on Facebook"
				   
				   
				   rel="nofollow">

				   <i class="wpusb-icon-facebook-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-twitter ">

				<a href="https://twitter.com/share?url=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share&text=Add%20P-values%20and%20Significance%20Levels%20to%20ggplots #rstats #datascience&via=rbloggers" target="_blank"
				   data-action="open-popup"
				   class="wpusb-layout-buttons wpusb-button wpusb-btn "
				   title="Tweet"
				   
				   
				   rel="nofollow">

				   <i class="wpusb-icon-twitter-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-linkedin ">

				<a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share&title=Add%20P-values%20and%20Significance%20Levels%20to%20ggplots" target="_blank"
				   data-action="open-popup"
				   class="wpusb-layout-buttons wpusb-button wpusb-btn "
				   title="Share on Linkedin"
				   
				   
				   rel="nofollow">

				   <i class="wpusb-icon-linkedin-buttons "></i>
				</a>
			</div>			<div class="wpusb-item wpusb-google-plus ">

				<a href="https://plus.google.com/share?url=https%3A%2F%2Fwww.r-bloggers.com%2Fadd-p-values-and-significance-levels-to-ggplots%2F%3Futm_source%3Dshare_buttons%26utm_medium%3Dsocial_media%26utm_campaign%3Dsocial_share" target="_blank"
				   data-action="open-popup"
				   class="wpusb-layout-buttons wpusb-button wpusb-btn "
				   title="Share on Google+"
				   
				   
				   rel="nofollow">

				   <i class="wpusb-icon-google-plus-buttons "></i>
				</a>
			</div>				</div>
				<span class="wpusb-toggle"
					  data-action="close-buttons"></span>
			</div>    <script type="text/rocketscript">
        var snp_f = [];
        var snp_hostname = new RegExp(location.host);
        var snp_http = new RegExp("^(http|https)://", "i");
        var snp_cookie_prefix = '';
        var snp_separate_cookies = false;
        var snp_ajax_url = 'https://www.r-bloggers.com/wp-admin/admin-ajax.php';
        var snp_ignore_cookies = false;
        var snp_enable_analytics_events = false;
        var snp_enable_mobile = false;
        var snp_use_in_all = false;
        var snp_excluded_urls = [];
        snp_excluded_urls.push('');    </script>
    <div class="snp-root">
        <input type="hidden" id="snp_popup" value="" />
        <input type="hidden" id="snp_popup_id" value="" />
        <input type="hidden" id="snp_popup_theme" value="" />
        <input type="hidden" id="snp_exithref" value="" />
        <input type="hidden" id="snp_exittarget" value="" />
    	<div id="snppopup-welcome" class="snp-pop-109583 snppopup"><input type="hidden" class="snp_open" value="scroll" /><input type="hidden" class="snp_show_on_exit" value="2" /><input type="hidden" class="snp_exit_js_alert_text" value="" /><input type="hidden" class="snp_open_scroll" value="50" /><input type="hidden" class="snp_optin_redirect_url" value="" /><input type="hidden" class="snp_show_cb_button" value="yes" /><input type="hidden" class="snp_popup_id" value="109583" /><input type="hidden" class="snp_popup_theme" value="theme6" /><input type="hidden" class="snp_overlay" value="disabled" /><input type="hidden" class="snp_cookie_conversion" value="30" /><input type="hidden" class="snp_cookie_close" value="180" /><div class="snp-fb snp-theme6">
    <div class="snp-subscribe-inner">
	<h1 class="snp-header"><i>Never miss an update! </i>
<br/>
<strong>Subscribe to R-bloggers</strong> to receive <br/>e-mails with the latest R posts.<br/>

<small>(You will not see this message again.)</small></h1>	<div class="snp-form">
	    <form action="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" method="post" class="snp-subscribeform snp_subscribeform">
				<fieldset>
		    <div class="snp-field">
			<input type="text" name="email" id="snp_email" placeholder="Your E-mail..." class="snp-field snp-field-email" />		
		    </div>
		    <button type="submit" class="snp-submit">Submit</button>
		</fieldset>
	    </form>
	</div>
	<a href="#" class="snp_nothanks snp-close">Click here to close (This popup will not appear again)</a>    </div>
    </div>
<style>.snp-pop-109583 .snp-theme6 { max-width: 700px;}
.snp-pop-109583 .snp-theme6 h1 {font-size: 17px;}
.snp-pop-109583 .snp-theme6 { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field ::-webkit-input-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-moz-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-ms-input-placeholder { color: #a0a4a9;}
.snp-pop-109583  .snp-theme6 .snp-field input { border: 1px solid #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field { color: #000000;}
.snp-pop-109583 .snp-theme6 { background: #f2f2f2;}
</style></div>    </div>
    <script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushClojure.js?ver=20090602"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=20091003"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushLatex.js?ver=20090613"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushMatlabKey.js?ver=20091209"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushObjC.js?ver=20091207"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushR.js?ver=20100919"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0.9b"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.9b"></script>
<script type="text/rocketscript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://www.r-bloggers.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<link rel='stylesheet' id='wpusb-style-css'  href='https://www.r-bloggers.com/wp-content/plugins/wpupper-share-buttons/assets/stylesheets/style.css?ver=1496217075' type='text/css' media='all' />
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/js/jquery.ck.min.js?ver=4.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/js/ninjapopups.min.js?ver=4.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/fancybox2/jquery.fancybox.min.js?ver=4.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-includes/js/comment-reply.min.js?ver=4.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/themes/magazine-basic/js/effects.js?ver=4.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/jetpack/modules/photon/photon.js?ver=20130122"></script>
<script type="text/rocketscript" data-rocketsrc="https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201723"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/lazy-load/js/jquery.sonar.min.js?ver=0.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/plugins/lazy-load/js/lazy-load.js?ver=0.6.1"></script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-includes/js/wp-embed.min.js?ver=4.6.1"></script>
	<div id="fb-root"></div>
	<script type="text/rocketscript" data-rocketsrc="https://platform.twitter.com/widgets.js"></script><script type="text/rocketscript" data-rocketsrc="//connect.facebook.net/en_US/all.js#xfbml=1"></script><script type="text/rocketscript" data-rocketsrc="https://apis.google.com/js/plusone.js"></script><script type="text/rocketscript" data-rocketsrc="https://platform.linkedin.com/in.js"></script><script type="text/rocketscript" data-rocketsrc="https://stats.wp.com/e-201723.js" async defer></script>
<script type="text/rocketscript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:4.7.1',blog:'11524731',post:'151648',tz:'-6',srv:'www.r-bloggers.com'} ]);
	_stq.push([ 'clickTrackerInit', '11524731', '151648' ]);
</script>
<script type="text/rocketscript" data-rocketsrc="https://www.r-bloggers.com/wp-content/themes/magazine-basic/js/effects.js"></script> 
<script type="text/rocketscript">
/* <![CDATA[ */
jQuery(function(){
	jQuery("ul.sf-menu").supersubs({ 
		minWidth:    12,
		maxWidth:    27,
		extraWidth:  1
	}).superfish({ 
		delay:       100,
		speed:       250 
	});	});
/* ]]> */
</script>



</body>
</html>
<!-- Dynamic page generated in 0.815 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2017-06-10 05:26:39 -->

<!-- Compression = gzip -->